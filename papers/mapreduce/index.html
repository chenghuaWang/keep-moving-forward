<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>MapReduce | Ubios Home</title>
<meta name="keywords" content="">
<meta name="description" content="OSDI&#39;04: 6th Symposium on Operating Systems Design and Implementation
go back to home
Paper link
ä»€ä¹ˆæ˜¯ MapReduce åœ¨MapReduceåŸæ–‡ä¸­æ˜¯è¿™ä¹ˆè¯´çš„
MapReduce is a programming model and an associated implementation for processing and generating large data sets. [1]
è¿™æ˜¯ä¸€ä¸ªè¾ƒä¸ºç®€å•çš„å¤„ç†å¤§å‹é—®é¢˜çš„åˆ†å¸ƒå¼ç¼–ç¨‹æ¨¡å‹ã€‚å…¶äº§ç”Ÿçš„åŸå› æ˜¯å› ä¸º google æƒ³è¦è®©æ™®é€šçš„ç¨‹åºå‘˜ä¹Ÿèƒ½å¤Ÿé€šè¿‡ä¸€å¥—ç®€å•çš„ç¼–ç¨‹æ¨¡å‹æ¥ç¼–å†™åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºï¼Œä»¥æ­¤æ¥å¤„ç† google å†…éƒ¨çš„å¤§æ•°æ®ã€‚ç„¶åè‘—åçš„ Jeff Dean å’Œ Sanjay Ghemawat å‡ºé©¬æå®šäº†è¿™ä¸ªé—®é¢˜(åœ¨çŸ¥ä¹ä¸Šå…³äºJeff Deançš„è½¶äº‹:-))ã€‚MapReduce åœ¨ google å†…éƒ¨è¿è¡Œå¾ˆé•¿çš„æ—¶é—´å¹¶ä¸”å¤„ç†äº†å¾ˆå¤šä¸šåŠ¡ï¼Œä½†æ˜¯ç›®å‰ä¹Ÿè´¥ä¸‹é˜µæ¥ï¼Œå…·ä½“åŸå› å‚è§ MapReduce ç¼ºé™·ç« èŠ‚(MRæ—©åœ¨2004å¹´å°±å‡ºæ¥äº†ï¼Œå…¶å®æ˜¯å¤æ—©çš„æŠ€æœ¯äº†ï¼Œå…¶æ²¡æœ‰åœ¨æ€§èƒ½ä¸Šåšæ–‡ç« ï¼Œä¸»è¦åœ¨å¯æ‰©å±•æ€§ä¸Š)ã€‚
MapReduce çš„è®¾è®¡æ¡†æ¶å’ŒåŸºæœ¬æµç¨‹ MRå®é™…ä¸Šæ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„æ¡†æ¶ï¼Œæ€è·¯ä¹Ÿéå¸¸çš„ç›´ç™½ã€‚MapReduce èƒŒåçš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†æ•°æ®é›†æ˜ å°„åˆ°ä¸€ä¸ª &lt;key, value&gt; pairçš„é›†åˆä¸­ï¼Œç„¶åä½¿ç”¨ç›¸åŒçš„é”®å¯¹æ‰€æœ‰pairè¿›è¡Œæ•´åˆã€‚ æ•´ä½“æ¦‚å¿µå¾ˆç®€å•ï¼Œä½†æ˜¯å¦‚æœä½ è®¾æƒ³ä¸‹ä¸‹é¢çš„æƒ…å†µï¼ŒMRå®é™…ä¸Šéå¸¸æœ‰ç”¨: åŸºæœ¬ä¸Šæ‰€æœ‰çš„æ•°æ®éƒ½èƒ½è¢«æ˜ å°„åˆ°ä¸€ä¸ª &lt;key, value&gt; å¯¹ä¸­ï¼Œå¹¶ä¸”keyå’Œvalueå¯ä»¥æ˜¯ä»»æ„ç±»å‹ã€‚
åœ¨è®ºæ–‡ä¸­MRä½¿ç”¨çš„æ ·ä¾‹æ˜¯åœ¨è¶…å¤§çš„æ–‡ä»¶é‡Œåšå•è¯ç»Ÿè®¡ã€‚è¿™ä¸ªæ¡†æ¶è¿˜å¯ä»¥ç”¨æ¥åšï¼š
åˆ†å¸ƒå¼çš„æ’åº åˆ†å¸ƒå¼çš„æœç´¢ Webé“¾æ¥å›¾éå† &hellip; Fig 1.">
<meta name="author" content="chenghua.Wang">
<link rel="canonical" href="https://chenghuawang.github.io/keep-moving-forward/papers/mapreduce/">
<link crossorigin="anonymous" href="/keep-moving-forward/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css" integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://chenghuawang.github.io/keep-moving-forward/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://chenghuawang.github.io/keep-moving-forward/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://chenghuawang.github.io/keep-moving-forward/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://chenghuawang.github.io/keep-moving-forward/apple-touch-icon.png">
<link rel="mask-icon" href="https://chenghuawang.github.io/keep-moving-forward/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://chenghuawang.github.io/keep-moving-forward/papers/mapreduce/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          
          
          delimiters: [
              {left: '$$', right: '$$', display: true},
              {left: '$', right: '$', display: false},
              {left: '\\(', right: '\\)', display: false},
              {left: '\\[', right: '\\]', display: true}
          ],
          
          throwOnError : false
        });
    });
</script>



  

<meta property="og:title" content="MapReduce" />
<meta property="og:description" content="OSDI&#39;04: 6th Symposium on Operating Systems Design and Implementation
go back to home
Paper link
ä»€ä¹ˆæ˜¯ MapReduce åœ¨MapReduceåŸæ–‡ä¸­æ˜¯è¿™ä¹ˆè¯´çš„
MapReduce is a programming model and an associated implementation for processing and generating large data sets. [1]
è¿™æ˜¯ä¸€ä¸ªè¾ƒä¸ºç®€å•çš„å¤„ç†å¤§å‹é—®é¢˜çš„åˆ†å¸ƒå¼ç¼–ç¨‹æ¨¡å‹ã€‚å…¶äº§ç”Ÿçš„åŸå› æ˜¯å› ä¸º google æƒ³è¦è®©æ™®é€šçš„ç¨‹åºå‘˜ä¹Ÿèƒ½å¤Ÿé€šè¿‡ä¸€å¥—ç®€å•çš„ç¼–ç¨‹æ¨¡å‹æ¥ç¼–å†™åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºï¼Œä»¥æ­¤æ¥å¤„ç† google å†…éƒ¨çš„å¤§æ•°æ®ã€‚ç„¶åè‘—åçš„ Jeff Dean å’Œ Sanjay Ghemawat å‡ºé©¬æå®šäº†è¿™ä¸ªé—®é¢˜(åœ¨çŸ¥ä¹ä¸Šå…³äºJeff Deançš„è½¶äº‹:-))ã€‚MapReduce åœ¨ google å†…éƒ¨è¿è¡Œå¾ˆé•¿çš„æ—¶é—´å¹¶ä¸”å¤„ç†äº†å¾ˆå¤šä¸šåŠ¡ï¼Œä½†æ˜¯ç›®å‰ä¹Ÿè´¥ä¸‹é˜µæ¥ï¼Œå…·ä½“åŸå› å‚è§ MapReduce ç¼ºé™·ç« èŠ‚(MRæ—©åœ¨2004å¹´å°±å‡ºæ¥äº†ï¼Œå…¶å®æ˜¯å¤æ—©çš„æŠ€æœ¯äº†ï¼Œå…¶æ²¡æœ‰åœ¨æ€§èƒ½ä¸Šåšæ–‡ç« ï¼Œä¸»è¦åœ¨å¯æ‰©å±•æ€§ä¸Š)ã€‚
MapReduce çš„è®¾è®¡æ¡†æ¶å’ŒåŸºæœ¬æµç¨‹ MRå®é™…ä¸Šæ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„æ¡†æ¶ï¼Œæ€è·¯ä¹Ÿéå¸¸çš„ç›´ç™½ã€‚MapReduce èƒŒåçš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†æ•°æ®é›†æ˜ å°„åˆ°ä¸€ä¸ª &lt;key, value&gt; pairçš„é›†åˆä¸­ï¼Œç„¶åä½¿ç”¨ç›¸åŒçš„é”®å¯¹æ‰€æœ‰pairè¿›è¡Œæ•´åˆã€‚ æ•´ä½“æ¦‚å¿µå¾ˆç®€å•ï¼Œä½†æ˜¯å¦‚æœä½ è®¾æƒ³ä¸‹ä¸‹é¢çš„æƒ…å†µï¼ŒMRå®é™…ä¸Šéå¸¸æœ‰ç”¨: åŸºæœ¬ä¸Šæ‰€æœ‰çš„æ•°æ®éƒ½èƒ½è¢«æ˜ å°„åˆ°ä¸€ä¸ª &lt;key, value&gt; å¯¹ä¸­ï¼Œå¹¶ä¸”keyå’Œvalueå¯ä»¥æ˜¯ä»»æ„ç±»å‹ã€‚
åœ¨è®ºæ–‡ä¸­MRä½¿ç”¨çš„æ ·ä¾‹æ˜¯åœ¨è¶…å¤§çš„æ–‡ä»¶é‡Œåšå•è¯ç»Ÿè®¡ã€‚è¿™ä¸ªæ¡†æ¶è¿˜å¯ä»¥ç”¨æ¥åšï¼š
åˆ†å¸ƒå¼çš„æ’åº åˆ†å¸ƒå¼çš„æœç´¢ Webé“¾æ¥å›¾éå† &hellip; Fig 1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://chenghuawang.github.io/keep-moving-forward/papers/mapreduce/" /><meta property="article:section" content="papers" />
<meta property="article:published_time" content="2023-01-17T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-01-17T00:00:00+00:00" />


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="MapReduce"/>
<meta name="twitter:description" content="OSDI&#39;04: 6th Symposium on Operating Systems Design and Implementation
go back to home
Paper link
ä»€ä¹ˆæ˜¯ MapReduce åœ¨MapReduceåŸæ–‡ä¸­æ˜¯è¿™ä¹ˆè¯´çš„
MapReduce is a programming model and an associated implementation for processing and generating large data sets. [1]
è¿™æ˜¯ä¸€ä¸ªè¾ƒä¸ºç®€å•çš„å¤„ç†å¤§å‹é—®é¢˜çš„åˆ†å¸ƒå¼ç¼–ç¨‹æ¨¡å‹ã€‚å…¶äº§ç”Ÿçš„åŸå› æ˜¯å› ä¸º google æƒ³è¦è®©æ™®é€šçš„ç¨‹åºå‘˜ä¹Ÿèƒ½å¤Ÿé€šè¿‡ä¸€å¥—ç®€å•çš„ç¼–ç¨‹æ¨¡å‹æ¥ç¼–å†™åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºï¼Œä»¥æ­¤æ¥å¤„ç† google å†…éƒ¨çš„å¤§æ•°æ®ã€‚ç„¶åè‘—åçš„ Jeff Dean å’Œ Sanjay Ghemawat å‡ºé©¬æå®šäº†è¿™ä¸ªé—®é¢˜(åœ¨çŸ¥ä¹ä¸Šå…³äºJeff Deançš„è½¶äº‹:-))ã€‚MapReduce åœ¨ google å†…éƒ¨è¿è¡Œå¾ˆé•¿çš„æ—¶é—´å¹¶ä¸”å¤„ç†äº†å¾ˆå¤šä¸šåŠ¡ï¼Œä½†æ˜¯ç›®å‰ä¹Ÿè´¥ä¸‹é˜µæ¥ï¼Œå…·ä½“åŸå› å‚è§ MapReduce ç¼ºé™·ç« èŠ‚(MRæ—©åœ¨2004å¹´å°±å‡ºæ¥äº†ï¼Œå…¶å®æ˜¯å¤æ—©çš„æŠ€æœ¯äº†ï¼Œå…¶æ²¡æœ‰åœ¨æ€§èƒ½ä¸Šåšæ–‡ç« ï¼Œä¸»è¦åœ¨å¯æ‰©å±•æ€§ä¸Š)ã€‚
MapReduce çš„è®¾è®¡æ¡†æ¶å’ŒåŸºæœ¬æµç¨‹ MRå®é™…ä¸Šæ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„æ¡†æ¶ï¼Œæ€è·¯ä¹Ÿéå¸¸çš„ç›´ç™½ã€‚MapReduce èƒŒåçš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†æ•°æ®é›†æ˜ å°„åˆ°ä¸€ä¸ª &lt;key, value&gt; pairçš„é›†åˆä¸­ï¼Œç„¶åä½¿ç”¨ç›¸åŒçš„é”®å¯¹æ‰€æœ‰pairè¿›è¡Œæ•´åˆã€‚ æ•´ä½“æ¦‚å¿µå¾ˆç®€å•ï¼Œä½†æ˜¯å¦‚æœä½ è®¾æƒ³ä¸‹ä¸‹é¢çš„æƒ…å†µï¼ŒMRå®é™…ä¸Šéå¸¸æœ‰ç”¨: åŸºæœ¬ä¸Šæ‰€æœ‰çš„æ•°æ®éƒ½èƒ½è¢«æ˜ å°„åˆ°ä¸€ä¸ª &lt;key, value&gt; å¯¹ä¸­ï¼Œå¹¶ä¸”keyå’Œvalueå¯ä»¥æ˜¯ä»»æ„ç±»å‹ã€‚
åœ¨è®ºæ–‡ä¸­MRä½¿ç”¨çš„æ ·ä¾‹æ˜¯åœ¨è¶…å¤§çš„æ–‡ä»¶é‡Œåšå•è¯ç»Ÿè®¡ã€‚è¿™ä¸ªæ¡†æ¶è¿˜å¯ä»¥ç”¨æ¥åšï¼š
åˆ†å¸ƒå¼çš„æ’åº åˆ†å¸ƒå¼çš„æœç´¢ Webé“¾æ¥å›¾éå† &hellip; Fig 1."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Papers",
      "item": "https://chenghuawang.github.io/keep-moving-forward/papers/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "MapReduce",
      "item": "https://chenghuawang.github.io/keep-moving-forward/papers/mapreduce/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "MapReduce",
  "name": "MapReduce",
  "description": "OSDI'04: 6th Symposium on Operating Systems Design and Implementation\ngo back to home\nPaper link\nä»€ä¹ˆæ˜¯ MapReduce åœ¨MapReduceåŸæ–‡ä¸­æ˜¯è¿™ä¹ˆè¯´çš„\nMapReduce is a programming model and an associated implementation for processing and generating large data sets. [1]\nè¿™æ˜¯ä¸€ä¸ªè¾ƒä¸ºç®€å•çš„å¤„ç†å¤§å‹é—®é¢˜çš„åˆ†å¸ƒå¼ç¼–ç¨‹æ¨¡å‹ã€‚å…¶äº§ç”Ÿçš„åŸå› æ˜¯å› ä¸º google æƒ³è¦è®©æ™®é€šçš„ç¨‹åºå‘˜ä¹Ÿèƒ½å¤Ÿé€šè¿‡ä¸€å¥—ç®€å•çš„ç¼–ç¨‹æ¨¡å‹æ¥ç¼–å†™åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºï¼Œä»¥æ­¤æ¥å¤„ç† google å†…éƒ¨çš„å¤§æ•°æ®ã€‚ç„¶åè‘—åçš„ Jeff Dean å’Œ Sanjay Ghemawat å‡ºé©¬æå®šäº†è¿™ä¸ªé—®é¢˜(åœ¨çŸ¥ä¹ä¸Šå…³äºJeff Deançš„è½¶äº‹:-))ã€‚MapReduce åœ¨ google å†…éƒ¨è¿è¡Œå¾ˆé•¿çš„æ—¶é—´å¹¶ä¸”å¤„ç†äº†å¾ˆå¤šä¸šåŠ¡ï¼Œä½†æ˜¯ç›®å‰ä¹Ÿè´¥ä¸‹é˜µæ¥ï¼Œå…·ä½“åŸå› å‚è§ MapReduce ç¼ºé™·ç« èŠ‚(MRæ—©åœ¨2004å¹´å°±å‡ºæ¥äº†ï¼Œå…¶å®æ˜¯å¤æ—©çš„æŠ€æœ¯äº†ï¼Œå…¶æ²¡æœ‰åœ¨æ€§èƒ½ä¸Šåšæ–‡ç« ï¼Œä¸»è¦åœ¨å¯æ‰©å±•æ€§ä¸Š)ã€‚\nMapReduce çš„è®¾è®¡æ¡†æ¶å’ŒåŸºæœ¬æµç¨‹ MRå®é™…ä¸Šæ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„æ¡†æ¶ï¼Œæ€è·¯ä¹Ÿéå¸¸çš„ç›´ç™½ã€‚MapReduce èƒŒåçš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†æ•°æ®é›†æ˜ å°„åˆ°ä¸€ä¸ª \u0026lt;key, value\u0026gt; pairçš„é›†åˆä¸­ï¼Œç„¶åä½¿ç”¨ç›¸åŒçš„é”®å¯¹æ‰€æœ‰pairè¿›è¡Œæ•´åˆã€‚ æ•´ä½“æ¦‚å¿µå¾ˆç®€å•ï¼Œä½†æ˜¯å¦‚æœä½ è®¾æƒ³ä¸‹ä¸‹é¢çš„æƒ…å†µï¼ŒMRå®é™…ä¸Šéå¸¸æœ‰ç”¨: åŸºæœ¬ä¸Šæ‰€æœ‰çš„æ•°æ®éƒ½èƒ½è¢«æ˜ å°„åˆ°ä¸€ä¸ª \u0026lt;key, value\u0026gt; å¯¹ä¸­ï¼Œå¹¶ä¸”keyå’Œvalueå¯ä»¥æ˜¯ä»»æ„ç±»å‹ã€‚\nåœ¨è®ºæ–‡ä¸­MRä½¿ç”¨çš„æ ·ä¾‹æ˜¯åœ¨è¶…å¤§çš„æ–‡ä»¶é‡Œåšå•è¯ç»Ÿè®¡ã€‚è¿™ä¸ªæ¡†æ¶è¿˜å¯ä»¥ç”¨æ¥åšï¼š\nåˆ†å¸ƒå¼çš„æ’åº åˆ†å¸ƒå¼çš„æœç´¢ Webé“¾æ¥å›¾éå† \u0026hellip; Fig 1.",
  "keywords": [
    
  ],
  "articleBody": "OSDI'04: 6th Symposium on Operating Systems Design and Implementation\ngo back to home\nPaper link\nä»€ä¹ˆæ˜¯ MapReduce åœ¨MapReduceåŸæ–‡ä¸­æ˜¯è¿™ä¹ˆè¯´çš„\nMapReduce is a programming model and an associated implementation for processing and generating large data sets. [1]\nè¿™æ˜¯ä¸€ä¸ªè¾ƒä¸ºç®€å•çš„å¤„ç†å¤§å‹é—®é¢˜çš„åˆ†å¸ƒå¼ç¼–ç¨‹æ¨¡å‹ã€‚å…¶äº§ç”Ÿçš„åŸå› æ˜¯å› ä¸º google æƒ³è¦è®©æ™®é€šçš„ç¨‹åºå‘˜ä¹Ÿèƒ½å¤Ÿé€šè¿‡ä¸€å¥—ç®€å•çš„ç¼–ç¨‹æ¨¡å‹æ¥ç¼–å†™åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºï¼Œä»¥æ­¤æ¥å¤„ç† google å†…éƒ¨çš„å¤§æ•°æ®ã€‚ç„¶åè‘—åçš„ Jeff Dean å’Œ Sanjay Ghemawat å‡ºé©¬æå®šäº†è¿™ä¸ªé—®é¢˜(åœ¨çŸ¥ä¹ä¸Šå…³äºJeff Deançš„è½¶äº‹:-))ã€‚MapReduce åœ¨ google å†…éƒ¨è¿è¡Œå¾ˆé•¿çš„æ—¶é—´å¹¶ä¸”å¤„ç†äº†å¾ˆå¤šä¸šåŠ¡ï¼Œä½†æ˜¯ç›®å‰ä¹Ÿè´¥ä¸‹é˜µæ¥ï¼Œå…·ä½“åŸå› å‚è§ MapReduce ç¼ºé™·ç« èŠ‚(MRæ—©åœ¨2004å¹´å°±å‡ºæ¥äº†ï¼Œå…¶å®æ˜¯å¤æ—©çš„æŠ€æœ¯äº†ï¼Œå…¶æ²¡æœ‰åœ¨æ€§èƒ½ä¸Šåšæ–‡ç« ï¼Œä¸»è¦åœ¨å¯æ‰©å±•æ€§ä¸Š)ã€‚\nMapReduce çš„è®¾è®¡æ¡†æ¶å’ŒåŸºæœ¬æµç¨‹ MRå®é™…ä¸Šæ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„æ¡†æ¶ï¼Œæ€è·¯ä¹Ÿéå¸¸çš„ç›´ç™½ã€‚MapReduce èƒŒåçš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†æ•°æ®é›†æ˜ å°„åˆ°ä¸€ä¸ª pairçš„é›†åˆä¸­ï¼Œç„¶åä½¿ç”¨ç›¸åŒçš„é”®å¯¹æ‰€æœ‰pairè¿›è¡Œæ•´åˆã€‚ æ•´ä½“æ¦‚å¿µå¾ˆç®€å•ï¼Œä½†æ˜¯å¦‚æœä½ è®¾æƒ³ä¸‹ä¸‹é¢çš„æƒ…å†µï¼ŒMRå®é™…ä¸Šéå¸¸æœ‰ç”¨: åŸºæœ¬ä¸Šæ‰€æœ‰çš„æ•°æ®éƒ½èƒ½è¢«æ˜ å°„åˆ°ä¸€ä¸ª å¯¹ä¸­ï¼Œå¹¶ä¸”keyå’Œvalueå¯ä»¥æ˜¯ä»»æ„ç±»å‹ã€‚\nåœ¨è®ºæ–‡ä¸­MRä½¿ç”¨çš„æ ·ä¾‹æ˜¯åœ¨è¶…å¤§çš„æ–‡ä»¶é‡Œåšå•è¯ç»Ÿè®¡ã€‚è¿™ä¸ªæ¡†æ¶è¿˜å¯ä»¥ç”¨æ¥åšï¼š\nåˆ†å¸ƒå¼çš„æ’åº åˆ†å¸ƒå¼çš„æœç´¢ Webé“¾æ¥å›¾éå† â€¦ Fig 1. MapReduce Archfrom â€œMapReduce: Simplified Data Processing on Large Clustersâ€ googleusercontent.com.\nMR ä¸­çš„Mapå’ŒReduceæ˜¯ä»å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€(LISP)ä¸­å€Ÿé‰´è¿‡æ¥çš„ä¸€ä¸ªæ¦‚å¿µã€‚ç¨‹åºå‘˜åªéœ€è¦ç¼–å†™Mapå’ŒReduceä¸¤ä¸ªå‡½æ•°å°±èƒ½å¤Ÿå¯¹æŸä¸ªä»»åŠ¡å¹¶å‘å¤„ç†ã€‚åœ¨ Fig 1 ä¸­ï¼ŒMRä¸»è¦çš„æµç¨‹åˆ†ä¸º6ä¸ªéƒ¨åˆ†\nç”¨æˆ·ç¨‹åºçš„MRé¦–å…ˆå°†è¾“å…¥æ–‡ä»¶åˆ†æˆ M å—ï¼Œæ¯å—é€šå¸¸ä¸º 16 MBåˆ° 64 MB(å¯ç”±ç”¨æˆ·é€šè¿‡å‚æ•°æ§åˆ¶)ã€‚ ç„¶åï¼Œå®ƒä¼šåœ¨ä¸€ç»„æœºå™¨ä¸Šå¯åŠ¨è¯¥ç¨‹åºçš„å¤šä¸ªå‰¯æœ¬ã€‚\nè¿™äº›å‰¯æœ¬ä¸­æœ‰ä¸€ä¸ªæ§åˆ¶ç¨‹åº(Master)ã€‚å…¶ä½™çš„ç¨‹åº(Worker)ç”±æ§åˆ¶ç¨‹åº(Master)æ¥åˆ†é…ã€‚æœ‰ M ä¸ª Map ä»»åŠ¡å’Œ R ä¸ª Reduce ä»»åŠ¡è¦åˆ†é…ã€‚Master æŒ‘é€‰ç©ºé—²çš„ Worker å¹¶ä¸ºæ¯ä¸ªæœºå™¨åˆ†é…ä¸€ä¸ª Map ä»»åŠ¡æˆ– Reduce ä»»åŠ¡ã€‚\nåˆ†é…äº† map ä»»åŠ¡çš„ worker è¯»å–ç›¸åº”çš„å†…å®¹(æ‹†åˆ†åçš„æ–‡ä»¶å—)(è®¾æƒ³ä¸‹ï¼Œå¦‚æœè¿™é‡Œçš„æ–‡ä»¶è¯»å–éœ€è¦ä»æ•°æ®ä»“åº“ä¸­æ‹¿å‡ºï¼Œé‚£ä¹ˆæ•´ä¸ªæ¡†æ¶çš„è®¡ç®—èƒ½åŠ›æå¤§çš„è¢«ç½‘ç»œæ‰€é™åˆ¶äº†)ã€‚å®ƒä»è¾“å…¥æ•°æ®ä¸­è§£æå‡ºå¯¹ï¼Œå¹¶å°†æ¯ä¸€å¯¹ä¼ é€’ç»™ç”¨æˆ·å®šä¹‰çš„ Map å‡½æ•°ã€‚ Map å‡½æ•°äº§ç”Ÿçš„ä¸­é—´å¯¹è¢«ç¼“å­˜åœ¨å†…å­˜ä¸­ã€‚\nç¼“å­˜åœ¨æœºå™¨ä¸­çš„ä¸­é—´å¯¹å‘¨æœŸæ€§åœ°è¢«å†™å…¥æœ¬åœ°ç£ç›˜ï¼Œç”±åˆ†åŒºå‡½æ•°åˆ’åˆ†ä¸º R ä¸ªåŒºåŸŸã€‚è¿™äº›ç¼“å†²å¯¹åœ¨æœ¬åœ°ç£ç›˜ä¸Šçš„ä½ç½®è¢«ä¼ å› Masterï¼ŒMaster è´Ÿè´£å°†è¿™äº›ä½ç½®è½¬å‘ç»™ Reduce Workerã€‚\nå½“ Master é€šçŸ¥ Reduce Worker æœ‰å…³è¿™äº›ä½ç½®æ—¶ï¼Œå®ƒä¼šä½¿ç”¨RPCä» Map Worker çš„æœ¬åœ°ç£ç›˜è¯»å–ç¼“å†²æ•°æ®ã€‚å½“ Reduce Worker è¯»å–æ‰€æœ‰ä¸­é—´æ•°æ®æ—¶ï¼Œå®ƒä¼šæŒ‰ä¸­é—´é”®å¯¹å…¶è¿›è¡Œæ’åºï¼Œä»¥ä¾¿å°†æ‰€æœ‰å‡ºç°çš„ç›¸åŒé”®ç»„åˆåœ¨ä¸€èµ·ã€‚æ’åºæ˜¯å› ä¸ºé€šå¸¸è®¸å¤šä¸åŒçš„é”®æ˜ å°„åˆ°åŒä¸€ä¸ª Reduce ä»»åŠ¡ã€‚å¦‚æœä¸­é—´æ•°æ®é‡å¤ªå¤§è€Œæ— æ³•æ”¾å…¥å†…å­˜ï¼Œåˆ™ä½¿ç”¨å¤–éƒ¨æ’åºã€‚\nReduce Worker è¿­ä»£æ’åºçš„ä¸­é—´æ•°æ®ï¼Œå¯¹äºé‡åˆ°çš„æ¯ä¸ªå”¯ä¸€ä¸­é—´é”®ï¼Œå®ƒå°†é”®å’Œç›¸åº”çš„ä¸­é—´å€¼é›†ä¼ é€’ç»™ç”¨æˆ·çš„ Reduce å‡½æ•°ã€‚Reduce å‡½æ•°çš„è¾“å‡ºåˆ°æ­¤ Reduce åˆ†åŒºçš„æœ€ç»ˆè¾“å‡ºæ–‡ä»¶ã€‚\nå½“æ‰€æœ‰çš„ Map ä»»åŠ¡å’Œ Reduce ä»»åŠ¡éƒ½å®Œæˆåï¼ŒMasterå”¤é†’ç”¨æˆ·ç¨‹åºã€‚æ­¤æ—¶ç”¨æˆ·ç¨‹åºä¸­çš„ MR è°ƒç”¨è¿”å›ç»™ç”¨æˆ·ä»£ç \nå› ä¸ºç½‘ç»œä¸Šçš„æ•°æ®äº¤æ¢æ˜¯éå¸¸ç¼“æ…¢çš„ï¼Œä½œè€…åœ¨åˆ†å‘æ•°æ®çš„æ—¶å€™å°½é‡ä¿è¯æ•°æ®å°±åœ¨è¿™å°è®¡ç®—æœåŠ¡å™¨ä¸Šï¼Œè€Œä¸éœ€è¦ä¼ è¾“æ•°æ®ã€‚åœ¨åŸæ–‡ä¸­æ˜¯è¿™æ ·è¯´çš„ï¼š\nWe conserve network bandwidth by taking advantage of the fact that the input data (managed by GFS) is stored on the local disks of the machines that make up our cluster.\nMapReduce çš„ä½¿ç”¨èŒƒä¾‹ è®ºæ–‡ä¸­ï¼Œä»¥è¯é¢‘ç»Ÿè®¡ä¸ºä¾‹å­ï¼Œå¦‚è®ºæ–‡ä¸­çš„ä¼ªä»£ç ï¼š\nmap(String key, String value):\r// key: document name\r// value: document contents\rfor each word w in value:\rEmitIntermediate(w, \"1\"); reduce(String key, Iterator values):\r// key: a word\r// values: a list of counts\rint result = 0;\rfor each v in values:\rresult += ParseInt(v);\rEmit(AsString(result)); MR Fault Tolerance Fault Tolerance åœ¨åˆ†å¸ƒå¼ç¨‹åºä¸­æ˜¯éå¸¸é‡è¦çš„ã€‚MR ä¸»è¦çš„è´¡çŒ®ç‚¹å…¶å®å°±åœ¨ scalability å’Œ fault toleranceã€‚\nWorker Failure Master ä¼šå®šæœŸçš„ ping Worker æœåŠ¡å™¨ï¼Œå¦‚æœä¸é€šï¼Œé‚£ä¹ˆè¿™ä¸ª Worker è¢«è®¾ç½®æˆ idleï¼Œåˆ†é…ç»™è¿™å°æœºå™¨çš„ä»»åŠ¡ä¼šè¢«åˆ†å‘ç»™å…¶ä»–çš„æœºå™¨ã€‚\nMaster Failure Master å› ä¸ºåªæœ‰å°‘é‡çš„æœºå™¨ï¼Œæ‰€ä»¥å‘ç”Ÿé”™è¯¯çš„å¯èƒ½æ€§éå¸¸çš„å°ã€‚å¯ä»¥é€šè¿‡å­˜å‚¨ Master çš„çŠ¶æ€ä¸º checkpoints æ¥è¿›è¡Œé”™è¯¯æ—¶å›é€€å’Œæ¢å¤ã€‚\nMR ç¼ºé™· MR çš„ç¼ºé™·å®é™…ä¸Šåœ¨ Google I/O ä¸Šå·²ç»è¯´æ˜äº†ï¼Œå¦‚ä¸‹:\nToday at Google I/O, we are demonstrating Google Cloud Dataflow for the first time. Cloud Dataflow is a fully managed service for creating data pipelines that ingest, transform and analyze data in both batch and streaming modes. Cloud Dataflow is a successor to MapReduce, and is based on our internal technologies like Flume and MillWheel.[2]\nMRæ˜¯ä¸€ä¸ªåŸºäº batch mode çš„æ¡†æ¶ã€‚ ç”¨ MR å†™å¤æ‚çš„åˆ†æ pipeline å¤ªéº»çƒ¦ã€‚ åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œä¸€æ¬¡ MR æ‰§è¡Œæ˜¯æ²¡æ³•æŠŠäº‹æƒ…åšå®Œçš„ï¼Œéœ€è¦å¾ˆå¤šä¸ª MR ä»»åŠ¡äº’ç›¸ç»„åˆï¼Œè¿™å°±æ˜¯ MR pipeline. åœ¨æ•°æ®æµå¤æ‚çš„åˆ†æä»»åŠ¡ä¸­ï¼Œè®¾è®¡å¥½çš„ pipeline è¾¾åˆ°æœ€é«˜è¿è¡Œæ•ˆç‡å¾ˆå›°éš¾ã€‚\nMR æœ€å¤§çš„è´¡çŒ®æˆ‘è®¤ä¸ºå°±æ˜¯ scalability å’Œ fault toleranceã€‚åœ¨ MillWheel é‡Œï¼Œç»“æœå¯ä»¥éšç€æ•°æ®æµçš„è¾“å…¥å®æ—¶çš„æ˜¾ç¤ºå‡ºæ¥ï¼Œè€Œä¸æ˜¯åˆ°æ•°æ®æµç»“æŸæ—¶æ‰è¾“å‡ºä¸€ä¸ªç»“æœï¼Œè€Œä¸”è¿™æ ·ä¸­é—´ç»“æœä¸éœ€è¦ä¿å­˜ä¸‹æ¥ã€‚\nMR Lab in MIT6.824 Check the lab-mr page here\nåœ¨æœ¬å®éªŒä¸­ï¼Œæˆ‘ä»¬å°†æ„å»ºä¸€ä¸ª MapReduce ç³»ç»Ÿã€‚ æˆ‘ä»¬å°†å®ç°ä¸€ä¸ªè°ƒç”¨åº”ç”¨ç¨‹åº Map å’Œ Reduce å‡½æ•°å¹¶å¤„ç†è¯»å†™æ–‡ä»¶çš„ç¨‹åºï¼Œä»¥åŠä¸€ä¸ªå°†ä»»åŠ¡åˆ†å‘ç»™ Worker å¹¶å¤„ç†å¤±è´¥çš„ Worker çš„è¿›ç¨‹(Master)ã€‚åœ¨ MR å®éªŒä¸­ï¼Œä½¿ç”¨ Golang æ¥ç¼–ç å®ç°ã€‚\næˆ‘çš„å®ç°åœ¨ WSL Ubuntu20.04 ä¸Š goç‰ˆæœ¬ 1.18ã€‚\nè¿™æ¬¡çš„è¦æ±‚è²Œä¼¼æ¯”ä»¥å‰æ›´éš¾äº†ï¼Œè¿™æ¬¡éœ€è¦ Worker ä¸»åŠ¨å‘ Master è¯·æ±‚ä»»åŠ¡ï¼Œå½“ä»»åŠ¡è¶…æ—¶åï¼Œéœ€è¦ Master æ¥é‡æ–°åˆ†é…è¿™ä¸ªä»»åŠ¡ã€‚\næ€»ä½“æ€è·¯å…¶å®ä¹Ÿéå¸¸çš„ç®€å•ï¼Œworker å’Œ coordinator çš„äº¤äº’éƒ½å›´ç»•ç€ RPC å±•å¼€ï¼Œæ•…å…ˆä» RPC çš„å®šä¹‰å¼€å§‹ã€‚å› ä¸ºæ·±å—äº‹ä»¶è½®è¯¢ç¼–ç¨‹æ¨¡å¼çš„â€™è¼æ¯’â€™ï¼Œæˆ‘æŠŠ worker å’Œ coordinator ä¹‹é—´çš„äº¤äº’è¿‡ç¨‹ä»¥äº‹ä»¶çš„å½¢å¼æ¥è¿›è¡Œå¤„ç†ã€‚é¦–å…ˆå®šä¹‰äº‹ä»¶çš„ç±»å‹ã€‚\n// src/mr/rpc.go type TaskTp = int const ( TpRequireTask = iota TpMapTaskDone TpReduceTaskDone TpSendMapTask TpSendReduceTask TpTaskAllDone TpWait ) å†æ¥è€ƒè™‘ RPC éœ€è¦åœ¨ worker å’Œ coordinator ä¸­ä¼ é€’ä»€ä¹ˆä¿¡æ¯ï¼Ÿä¸è®ºä½•ç§ä¿¡æ¯ï¼Œé¦–å…ˆéƒ½éœ€è¦ä¸€ä¸ªæ—¶é—´æˆ³æ¥è®°å½• require å’Œ reply å¯¹ã€‚å…¶æ¬¡æ¯ä¸ª worker éƒ½éœ€è¦çŸ¥é“ä¸€å…±æœ‰å¤šå°‘ä¸ª Map å’Œ Reduce ä»»åŠ¡ã€‚æ¯ä¸ª require éœ€è¦è·Ÿä¸Šå½“å‰ worker çš„ä»»åŠ¡ç¼–å·ã€‚å½“ç„¶ï¼Œå› ä¸ºæ˜¯äº‹ä»¶é©±åŠ¨çš„è§’åº¦ç¼–å†™çš„ï¼Œæ‰€ä»¥æ¯æ¡ require å’Œ reply éƒ½éœ€è¦æœ‰ä¸€ä¸ªäº‹ä»¶ç±»å‹è®°å½•ã€‚\n// src/mr/rpc.go type RequireMsg struct { Stamp int64 MsgFlag TaskTp TaskID int } type ReplyMsg struct { Stamp int64 MsgFlag TaskTp TaskID int NumReduceWorkers int NumMapWorkers int Content string } å¯¹äº coordinatorï¼Œå…¶ä½œç”¨åƒæ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼Œéœ€è¦ç»´æŠ¤æ‰€æœ‰çš„ worker çš„çŠ¶æ€ï¼Œå¹¶èƒ½åšåˆ°å›é€€(Fault Tolerance)ã€‚Coordinator çš„å®šä¹‰å¦‚ä¸‹\n// src/mr/coordinator.go type Coordinator struct { nMapWorkers int nReduceWorkers int nMapWorking int nReduceWorking int MapWorkerState []int64 ReduceWorkerState []int64 FilesContent []string MapWorkerPool chan int ReduceWorkerPool chan int IsDone bool GlobalLock *sync.Cond // to make sure the rpc visit is atomic. } coordinator éœ€è¦å¤„ç† RPC çš„è¯·æ±‚ï¼Œå¯¹äºä¸åŒçš„äº‹ä»¶è¿›è¡Œååº”ã€‚å› ä¸ºéœ€è¦è¶…æ—¶å¤„ç†ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œï¼Œæ¯ä¸€ä¸ª worker éƒ½ä¼šæœ‰ä¸€ä¸ªåç¨‹æ¥è¿›è¡Œç›¸åº”çš„è®¡æ—¶å’Œ id å›æ”¶ã€‚\n// src/mr/coordinator.go func (c *Coordinator) ProcessEvents(args *RequireMsg, reply *ReplyMsg) error { c.GlobalLock.L.Lock() tmpBool := c.IsDone c.GlobalLock.L.Unlock() if tmpBool { reply.MsgFlag = TpTaskAllDone reply.Stamp = args.Stamp return nil } switch args.MsgFlag { case TpMapTaskDone: c.GlobalLock.L.Lock() if c.MapWorkerState[args.TaskID] == args.Stamp { c.MapWorkerState[args.TaskID] = 1 c.nMapWorking-- } c.GlobalLock.L.Unlock() case TpReduceTaskDone: c.GlobalLock.L.Lock() if c.ReduceWorkerState[args.TaskID] == args.Stamp { c.ReduceWorkerState[args.TaskID] = 1 c.nReduceWorking-- } if c.nReduceWorking == 0 { c.IsDone = true } c.GlobalLock.L.Unlock() case TpRequireTask: if len(c.MapWorkerPool) \u003e 0 { // State 1. Send Map Task to worker. reply.Stamp = args.Stamp reply.TaskID = \u003c-c.MapWorkerPool reply.MsgFlag = TpSendMapTask reply.NumMapWorkers = c.nMapWorkers reply.NumReduceWorkers = c.nReduceWorkers reply.Content = c.FilesContent[reply.TaskID] c.GlobalLock.L.Lock() c.MapWorkerState[reply.TaskID] = args.Stamp c.GlobalLock.L.Unlock() go func(id int) { time.Sleep(10 * time.Second) c.GlobalLock.L.Lock() if c.MapWorkerState[id] != 1 { // run out of 10 secs. recycle this id to id pool. c.MapWorkerPool \u003c- id } c.GlobalLock.L.Unlock() }(reply.TaskID) return nil } else { c.GlobalLock.L.Lock() nMapOnWorking := c.nMapWorking nReduceOnWorking := c.nReduceWorking c.GlobalLock.L.Unlock() // State 2. All map worker is on working. wait. if nMapOnWorking != 0 { reply.Stamp = args.Stamp reply.TaskID = -1 reply.MsgFlag = TpWait reply.Content = \"Just Wait !!! Map Worker !!!\" reply.NumMapWorkers = c.nMapWorkers reply.NumReduceWorkers = c.nReduceWorkers } else { // State 3. Map is Done. Send Reduce task to works. if len(c.ReduceWorkerPool) \u003e 0 { reply.Stamp = args.Stamp reply.TaskID = \u003c-c.ReduceWorkerPool reply.MsgFlag = TpSendReduceTask reply.Content = \"Reduce no need to handle this\" reply.NumMapWorkers = c.nMapWorkers reply.NumReduceWorkers = c.nReduceWorkers c.GlobalLock.L.Lock() c.ReduceWorkerState[reply.TaskID] = args.Stamp c.GlobalLock.L.Unlock() go func(id int) { time.Sleep(10 * time.Second) c.GlobalLock.L.Lock() if c.ReduceWorkerState[id] != 1 { // run out of 10 secs. resolved this id to id pool. c.ReduceWorkerPool \u003c- id } c.GlobalLock.L.Unlock() }(reply.TaskID) } else { // State 4. All reduce worker is on working. wait. if nReduceOnWorking != 0 { reply.Stamp = args.Stamp reply.TaskID = -1 reply.MsgFlag = TpWait reply.Content = \"Just Wait !!! Reduce Worker !!!\" reply.NumMapWorkers = c.nMapWorkers reply.NumReduceWorkers = c.nReduceWorkers } } } } default: return nil } return nil } åŒæ ·çš„ï¼Œåœ¨ worker ä¸­çš„æµç¨‹ä¹Ÿæ˜¯ä¸æ–­çš„å¾ªç¯äº§ç”Ÿäº‹ä»¶ï¼Œå¤„ç†äº‹ä»¶\n// src/mr/worker.go func Worker(mapf func(string, string) []KeyValue, reducef func(string, []string) string) { for true { ThisStamp := time.Now().Unix() Req := RequireMsg{} Req.Stamp = ThisStamp Req.MsgFlag = TpRequireTask Req.TaskID = -1 Rep := ReplyMsg{} ok := call(\"Coordinator.ProcessEvents\", \u0026Req, \u0026Rep) if ok \u0026\u0026 Rep.Stamp == Req.Stamp { switch Rep.MsgFlag { case TpSendMapTask: doMap(mapf, \u0026Rep) case TpSendReduceTask: doReduce(reducef, \u0026Rep) case TpWait: time.Sleep(time.Second) case TpTaskAllDone: return default: return } } } return } doMap(mapf, \u0026Rep) å’Œ doReduce(reducef, \u0026Rep) å°±æ˜¯éå¸¸ç®€å•çš„é€»è¾‘ç¼–å†™äº†ã€‚Mapéœ€è¦æŠŠæ–‡ä»¶åˆ†æ‹†åˆ°N=numReduceå—ä¸­ï¼Œæ€»å…±äº§ç”ŸN * M(reduce num, map num)å—æ–‡ä»¶ã€‚Reduce workerä»è‡ªå·±å¯¹åº”çš„ç¼–å·ä¸­å–å‡ºMå—è¿›è¡Œæ’åºå’Œåˆå¹¶ã€‚\nç»“æœé¡ºåˆ©é€šè¿‡ï¼Œæ²¡æœ‰è¿‡å¤šçš„å»¶è¿Ÿ(å› ä¸º10sçš„åˆ¤æ–­)äº§ç”Ÿã€‚\nFig 2. test mr Reference [1] â€œMapReduce: Simplified Data Processing on Large Clustersâ€ googleusercontent.com.\n[2] Google cloud blog about MapReduceâ€™s successor\n",
  "wordCount" : "959",
  "inLanguage": "en",
  "datePublished": "2023-01-17T00:00:00Z",
  "dateModified": "2023-01-17T00:00:00Z",
  "author":[{
    "@type": "Person",
    "name": "chenghua.Wang"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://chenghuawang.github.io/keep-moving-forward/papers/mapreduce/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Ubios Home",
    "logo": {
      "@type": "ImageObject",
      "url": "https://chenghuawang.github.io/keep-moving-forward/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://chenghuawang.github.io/keep-moving-forward/" accesskey="h" title="Ubios Home (Alt + H)">Ubios Home</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://chenghuawang.github.io/keep-moving-forward/about/about/" title="å…³äºæˆ‘">
                    <span>å…³äºæˆ‘</span>
                </a>
            </li>
            <li>
                <a href="https://chenghuawang.github.io/keep-moving-forward/about/tech_posts/" title="æŠ€æœ¯ç›¸å…³">
                    <span>æŠ€æœ¯ç›¸å…³</span>
                </a>
            </li>
            <li>
                <a href="https://chenghuawang.github.io/keep-moving-forward/about/paper_posts/" title="è®ºæ–‡è§£æ">
                    <span>è®ºæ–‡è§£æ</span>
                </a>
            </li>
            <li>
                <a href="https://chenghuawang.github.io/keep-moving-forward/about/news/" title="ğŸ‰NewsğŸ‰">
                    <span>ğŸ‰NewsğŸ‰</span>
                </a>
            </li>
            <li>
                <a href="https://chenghuawang.github.io/keep-moving-forward/about/thingking/" title="æ€è€ƒ">
                    <span>æ€è€ƒ</span>
                </a>
            </li>
            <li>
                <a href="https://chenghuawang.github.io/keep-moving-forward/about/hpc_ai/" title="AI&amp;Sys å…¥é—¨">
                    <span>AI&amp;Sys å…¥é—¨</span>
                </a>
            </li>
            <li>
                <a href="https://chenghuawang.github.io/keep-moving-forward/tags/" title="æ ‡ç­¾">
                    <span>æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://chenghuawang.github.io/keep-moving-forward/series" title="ç³»åˆ—æ–‡ç« ">
                    <span>ç³»åˆ—æ–‡ç« </span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://chenghuawang.github.io/keep-moving-forward/">Home</a>&nbsp;Â»&nbsp;<a href="https://chenghuawang.github.io/keep-moving-forward/papers/">Papers</a></div>
    <h1 class="post-title entry-hint-parent">
      MapReduce
    </h1>
    <div class="post-meta"><span title='2023-01-17 00:00:00 +0000 UTC'>January 17, 2023</span>&nbsp;Â·&nbsp;5 min&nbsp;Â·&nbsp;chenghua.Wang

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e4%bb%80%e4%b9%88%e6%98%af-mapreduce" aria-label="ä»€ä¹ˆæ˜¯ MapReduce">ä»€ä¹ˆæ˜¯ MapReduce</a><ul>
                        
                <li>
                    <a href="#mapreduce-%e7%9a%84%e8%ae%be%e8%ae%a1%e6%a1%86%e6%9e%b6%e5%92%8c%e5%9f%ba%e6%9c%ac%e6%b5%81%e7%a8%8b" aria-label="MapReduce çš„è®¾è®¡æ¡†æ¶å’ŒåŸºæœ¬æµç¨‹">MapReduce çš„è®¾è®¡æ¡†æ¶å’ŒåŸºæœ¬æµç¨‹</a></li></ul>
                </li>
                <li>
                    <a href="#mapreduce-%e7%9a%84%e4%bd%bf%e7%94%a8%e8%8c%83%e4%be%8b" aria-label="MapReduce çš„ä½¿ç”¨èŒƒä¾‹">MapReduce çš„ä½¿ç”¨èŒƒä¾‹</a></li>
                <li>
                    <a href="#mr-fault-tolerance" aria-label="MR Fault Tolerance">MR Fault Tolerance</a><ul>
                        
                <li>
                    <a href="#worker-failure" aria-label="Worker Failure">Worker Failure</a></li>
                <li>
                    <a href="#master-failure" aria-label="Master Failure">Master Failure</a></li></ul>
                </li>
                <li>
                    <a href="#mr-%e7%bc%ba%e9%99%b7" aria-label="MR ç¼ºé™·">MR ç¼ºé™·</a></li>
                <li>
                    <a href="#mr-lab-in-mit6824" aria-label="MR Lab in MIT6.824">MR Lab in MIT6.824</a></li>
                <li>
                    <a href="#reference" aria-label="Reference">Reference</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>OSDI'04: 6th Symposium on Operating Systems Design and Implementation</p>
<p><a href="/keep-moving-forward/">go back to home</a></p>
<p><a href="https://pdos.csail.mit.edu/6.824/papers/mapreduce.pdf">Paper link</a></p>
<hr>
<h1 id="ä»€ä¹ˆæ˜¯-mapreduce">ä»€ä¹ˆæ˜¯ MapReduce<a hidden class="anchor" aria-hidden="true" href="#ä»€ä¹ˆæ˜¯-mapreduce">#</a></h1>
<p>åœ¨MapReduceåŸæ–‡ä¸­æ˜¯è¿™ä¹ˆè¯´çš„</p>
<blockquote>
<p>MapReduce is a programming model and an associated implementation for processing and generating large data sets. [1]</p>
</blockquote>
<p>è¿™æ˜¯ä¸€ä¸ªè¾ƒä¸ºç®€å•çš„å¤„ç†å¤§å‹é—®é¢˜çš„åˆ†å¸ƒå¼ç¼–ç¨‹æ¨¡å‹ã€‚å…¶äº§ç”Ÿçš„åŸå› æ˜¯å› ä¸º google æƒ³è¦è®©æ™®é€šçš„ç¨‹åºå‘˜ä¹Ÿèƒ½å¤Ÿé€šè¿‡ä¸€å¥—ç®€å•çš„ç¼–ç¨‹æ¨¡å‹æ¥ç¼–å†™åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºï¼Œä»¥æ­¤æ¥å¤„ç† google å†…éƒ¨çš„å¤§æ•°æ®ã€‚ç„¶åè‘—åçš„ Jeff Dean å’Œ Sanjay Ghemawat å‡ºé©¬æå®šäº†è¿™ä¸ªé—®é¢˜(<a href="https://www.zhihu.com/question/22081653">åœ¨çŸ¥ä¹ä¸Šå…³äºJeff Deançš„è½¶äº‹:-)</a>)ã€‚MapReduce åœ¨ google å†…éƒ¨è¿è¡Œå¾ˆé•¿çš„æ—¶é—´å¹¶ä¸”å¤„ç†äº†å¾ˆå¤šä¸šåŠ¡ï¼Œä½†æ˜¯ç›®å‰ä¹Ÿè´¥ä¸‹é˜µæ¥ï¼Œå…·ä½“åŸå› å‚è§ MapReduce ç¼ºé™·ç« èŠ‚(MRæ—©åœ¨2004å¹´å°±å‡ºæ¥äº†ï¼Œå…¶å®æ˜¯å¤æ—©çš„æŠ€æœ¯äº†ï¼Œå…¶æ²¡æœ‰åœ¨æ€§èƒ½ä¸Šåšæ–‡ç« ï¼Œä¸»è¦åœ¨å¯æ‰©å±•æ€§ä¸Š)ã€‚</p>
<h2 id="mapreduce-çš„è®¾è®¡æ¡†æ¶å’ŒåŸºæœ¬æµç¨‹">MapReduce çš„è®¾è®¡æ¡†æ¶å’ŒåŸºæœ¬æµç¨‹<a hidden class="anchor" aria-hidden="true" href="#mapreduce-çš„è®¾è®¡æ¡†æ¶å’ŒåŸºæœ¬æµç¨‹">#</a></h2>
<p>MRå®é™…ä¸Šæ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„æ¡†æ¶ï¼Œæ€è·¯ä¹Ÿéå¸¸çš„ç›´ç™½ã€‚MapReduce èƒŒåçš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†æ•°æ®é›†æ˜ å°„åˆ°ä¸€ä¸ª <code>&lt;key, value&gt;</code> pairçš„é›†åˆä¸­ï¼Œç„¶åä½¿ç”¨ç›¸åŒçš„é”®å¯¹æ‰€æœ‰pairè¿›è¡Œæ•´åˆã€‚ æ•´ä½“æ¦‚å¿µå¾ˆç®€å•ï¼Œä½†æ˜¯å¦‚æœä½ è®¾æƒ³ä¸‹ä¸‹é¢çš„æƒ…å†µï¼ŒMRå®é™…ä¸Šéå¸¸æœ‰ç”¨: åŸºæœ¬ä¸Šæ‰€æœ‰çš„æ•°æ®éƒ½èƒ½è¢«æ˜ å°„åˆ°ä¸€ä¸ª <code>&lt;key, value&gt;</code> å¯¹ä¸­ï¼Œå¹¶ä¸”keyå’Œvalueå¯ä»¥æ˜¯ä»»æ„ç±»å‹ã€‚</p>
<p>åœ¨è®ºæ–‡ä¸­MRä½¿ç”¨çš„æ ·ä¾‹æ˜¯åœ¨è¶…å¤§çš„æ–‡ä»¶é‡Œåšå•è¯ç»Ÿè®¡ã€‚è¿™ä¸ªæ¡†æ¶è¿˜å¯ä»¥ç”¨æ¥åšï¼š</p>
<ol>
<li>åˆ†å¸ƒå¼çš„æ’åº</li>
<li>åˆ†å¸ƒå¼çš„æœç´¢</li>
<li>Webé“¾æ¥å›¾éå†</li>
<li>&hellip;</li>
</ol>
<hr>
<figure>
    <img loading="lazy" src="MapReduceArch.png"
         alt="from &amp;ldquo;MapReduce: Simplified Data Processing on Large Clusters&amp;rdquo; googleusercontent.com."/> <figcaption>
            Fig 1. MapReduce Arch<p>from &ldquo;MapReduce: Simplified Data Processing on Large Clusters&rdquo; googleusercontent.com.</p>
        </figcaption>
</figure>

<p>MR ä¸­çš„Mapå’ŒReduceæ˜¯ä»å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€(LISP)ä¸­å€Ÿé‰´è¿‡æ¥çš„ä¸€ä¸ªæ¦‚å¿µã€‚ç¨‹åºå‘˜åªéœ€è¦ç¼–å†™Mapå’ŒReduceä¸¤ä¸ªå‡½æ•°å°±èƒ½å¤Ÿå¯¹æŸä¸ªä»»åŠ¡å¹¶å‘å¤„ç†ã€‚åœ¨ Fig 1 ä¸­ï¼ŒMRä¸»è¦çš„æµç¨‹åˆ†ä¸º6ä¸ªéƒ¨åˆ†</p>
<ol>
<li>
<p>ç”¨æˆ·ç¨‹åºçš„MRé¦–å…ˆå°†è¾“å…¥æ–‡ä»¶åˆ†æˆ M å—ï¼Œæ¯å—é€šå¸¸ä¸º 16 MBåˆ° 64 MB(å¯ç”±ç”¨æˆ·é€šè¿‡å‚æ•°æ§åˆ¶)ã€‚ ç„¶åï¼Œå®ƒä¼šåœ¨ä¸€ç»„æœºå™¨ä¸Šå¯åŠ¨è¯¥ç¨‹åºçš„å¤šä¸ªå‰¯æœ¬ã€‚</p>
</li>
<li>
<p>è¿™äº›å‰¯æœ¬ä¸­æœ‰ä¸€ä¸ªæ§åˆ¶ç¨‹åº(Master)ã€‚å…¶ä½™çš„ç¨‹åº(Worker)ç”±æ§åˆ¶ç¨‹åº(Master)æ¥åˆ†é…ã€‚æœ‰ M ä¸ª Map ä»»åŠ¡å’Œ R ä¸ª Reduce ä»»åŠ¡è¦åˆ†é…ã€‚Master æŒ‘é€‰ç©ºé—²çš„ Worker å¹¶ä¸ºæ¯ä¸ªæœºå™¨åˆ†é…ä¸€ä¸ª Map ä»»åŠ¡æˆ– Reduce ä»»åŠ¡ã€‚</p>
</li>
<li>
<p>åˆ†é…äº† map ä»»åŠ¡çš„ worker è¯»å–ç›¸åº”çš„å†…å®¹(æ‹†åˆ†åçš„æ–‡ä»¶å—)(è®¾æƒ³ä¸‹ï¼Œå¦‚æœè¿™é‡Œçš„æ–‡ä»¶è¯»å–éœ€è¦ä»æ•°æ®ä»“åº“ä¸­æ‹¿å‡ºï¼Œé‚£ä¹ˆæ•´ä¸ªæ¡†æ¶çš„è®¡ç®—èƒ½åŠ›æå¤§çš„è¢«ç½‘ç»œæ‰€é™åˆ¶äº†)ã€‚å®ƒä»è¾“å…¥æ•°æ®ä¸­è§£æå‡º<code>&lt;key, value&gt;</code>å¯¹ï¼Œå¹¶å°†æ¯ä¸€å¯¹ä¼ é€’ç»™ç”¨æˆ·å®šä¹‰çš„ Map å‡½æ•°ã€‚ Map å‡½æ•°äº§ç”Ÿçš„ä¸­é—´<code>&lt;key, value&gt;</code>å¯¹è¢«ç¼“å­˜åœ¨å†…å­˜ä¸­ã€‚</p>
</li>
<li>
<p>ç¼“å­˜åœ¨æœºå™¨ä¸­çš„ä¸­é—´<code>&lt;key, value&gt;</code>å¯¹å‘¨æœŸæ€§åœ°è¢«å†™å…¥æœ¬åœ°ç£ç›˜ï¼Œç”±åˆ†åŒºå‡½æ•°åˆ’åˆ†ä¸º R ä¸ªåŒºåŸŸã€‚è¿™äº›ç¼“å†²å¯¹åœ¨æœ¬åœ°ç£ç›˜ä¸Šçš„ä½ç½®è¢«ä¼ å› Masterï¼ŒMaster è´Ÿè´£å°†è¿™äº›ä½ç½®è½¬å‘ç»™ Reduce Workerã€‚</p>
</li>
<li>
<p>å½“ Master é€šçŸ¥ Reduce Worker æœ‰å…³è¿™äº›ä½ç½®æ—¶ï¼Œå®ƒä¼šä½¿ç”¨RPCä» Map Worker çš„æœ¬åœ°ç£ç›˜è¯»å–ç¼“å†²æ•°æ®ã€‚å½“ Reduce Worker è¯»å–æ‰€æœ‰ä¸­é—´æ•°æ®æ—¶ï¼Œå®ƒä¼šæŒ‰ä¸­é—´é”®å¯¹å…¶è¿›è¡Œæ’åºï¼Œä»¥ä¾¿å°†æ‰€æœ‰å‡ºç°çš„ç›¸åŒé”®ç»„åˆåœ¨ä¸€èµ·ã€‚æ’åºæ˜¯å› ä¸ºé€šå¸¸è®¸å¤šä¸åŒçš„é”®æ˜ å°„åˆ°åŒä¸€ä¸ª Reduce ä»»åŠ¡ã€‚å¦‚æœä¸­é—´æ•°æ®é‡å¤ªå¤§è€Œæ— æ³•æ”¾å…¥å†…å­˜ï¼Œåˆ™ä½¿ç”¨å¤–éƒ¨æ’åºã€‚</p>
</li>
<li>
<p>Reduce Worker è¿­ä»£æ’åºçš„ä¸­é—´æ•°æ®ï¼Œå¯¹äºé‡åˆ°çš„æ¯ä¸ªå”¯ä¸€ä¸­é—´é”®ï¼Œå®ƒå°†é”®å’Œç›¸åº”çš„ä¸­é—´å€¼é›†ä¼ é€’ç»™ç”¨æˆ·çš„ Reduce å‡½æ•°ã€‚Reduce å‡½æ•°çš„è¾“å‡ºåˆ°æ­¤ Reduce åˆ†åŒºçš„æœ€ç»ˆè¾“å‡ºæ–‡ä»¶ã€‚</p>
</li>
<li>
<p>å½“æ‰€æœ‰çš„ Map ä»»åŠ¡å’Œ Reduce ä»»åŠ¡éƒ½å®Œæˆåï¼ŒMasterå”¤é†’ç”¨æˆ·ç¨‹åºã€‚æ­¤æ—¶ç”¨æˆ·ç¨‹åºä¸­çš„ MR è°ƒç”¨è¿”å›ç»™ç”¨æˆ·ä»£ç </p>
</li>
</ol>
<p>å› ä¸ºç½‘ç»œä¸Šçš„æ•°æ®äº¤æ¢æ˜¯éå¸¸ç¼“æ…¢çš„ï¼Œä½œè€…åœ¨åˆ†å‘æ•°æ®çš„æ—¶å€™å°½é‡ä¿è¯æ•°æ®å°±åœ¨è¿™å°è®¡ç®—æœåŠ¡å™¨ä¸Šï¼Œè€Œä¸éœ€è¦ä¼ è¾“æ•°æ®ã€‚åœ¨åŸæ–‡ä¸­æ˜¯è¿™æ ·è¯´çš„ï¼š</p>
<blockquote>
<p>We conserve network bandwidth by taking advantage of the fact that the input data (managed by GFS) is stored on the local disks of the
machines that make up our cluster.</p>
</blockquote>
<h1 id="mapreduce-çš„ä½¿ç”¨èŒƒä¾‹">MapReduce çš„ä½¿ç”¨èŒƒä¾‹<a hidden class="anchor" aria-hidden="true" href="#mapreduce-çš„ä½¿ç”¨èŒƒä¾‹">#</a></h1>
<p>è®ºæ–‡ä¸­ï¼Œä»¥è¯é¢‘ç»Ÿè®¡ä¸ºä¾‹å­ï¼Œå¦‚è®ºæ–‡ä¸­çš„ä¼ªä»£ç ï¼š</p>
<pre tabindex="0"><code>map(String key, String value):
    // key: document name
    // value: document contents
    for each word w in value:
        EmitIntermediate(w, &#34;1&#34;);
</code></pre><pre tabindex="0"><code>reduce(String key, Iterator values):
    // key: a word
    // values: a list of counts
    int result = 0;
    for each v in values:
        result += ParseInt(v);
        Emit(AsString(result));
</code></pre><h1 id="mr-fault-tolerance">MR Fault Tolerance<a hidden class="anchor" aria-hidden="true" href="#mr-fault-tolerance">#</a></h1>
<p>Fault Tolerance åœ¨åˆ†å¸ƒå¼ç¨‹åºä¸­æ˜¯éå¸¸é‡è¦çš„ã€‚MR ä¸»è¦çš„è´¡çŒ®ç‚¹å…¶å®å°±åœ¨ scalability å’Œ fault toleranceã€‚</p>
<h2 id="worker-failure">Worker Failure<a hidden class="anchor" aria-hidden="true" href="#worker-failure">#</a></h2>
<p>Master ä¼šå®šæœŸçš„ ping Worker æœåŠ¡å™¨ï¼Œå¦‚æœä¸é€šï¼Œé‚£ä¹ˆè¿™ä¸ª Worker è¢«è®¾ç½®æˆ idleï¼Œåˆ†é…ç»™è¿™å°æœºå™¨çš„ä»»åŠ¡ä¼šè¢«åˆ†å‘ç»™å…¶ä»–çš„æœºå™¨ã€‚</p>
<h2 id="master-failure">Master Failure<a hidden class="anchor" aria-hidden="true" href="#master-failure">#</a></h2>
<p>Master å› ä¸ºåªæœ‰å°‘é‡çš„æœºå™¨ï¼Œæ‰€ä»¥å‘ç”Ÿé”™è¯¯çš„å¯èƒ½æ€§éå¸¸çš„å°ã€‚å¯ä»¥é€šè¿‡å­˜å‚¨ Master çš„çŠ¶æ€ä¸º checkpoints æ¥è¿›è¡Œé”™è¯¯æ—¶å›é€€å’Œæ¢å¤ã€‚</p>
<h1 id="mr-ç¼ºé™·">MR ç¼ºé™·<a hidden class="anchor" aria-hidden="true" href="#mr-ç¼ºé™·">#</a></h1>
<p>MR çš„ç¼ºé™·å®é™…ä¸Šåœ¨ Google I/O ä¸Šå·²ç»è¯´æ˜äº†ï¼Œå¦‚ä¸‹:</p>
<blockquote>
<p>Today at Google I/O, we are demonstrating Google Cloud Dataflow for the first time. Cloud Dataflow is a fully managed service for creating data pipelines that ingest, transform and analyze data in both batch and streaming modes. Cloud Dataflow is a successor to MapReduce, and is based on our internal technologies like Flume and MillWheel.[2]</p>
</blockquote>
<ol>
<li>MRæ˜¯ä¸€ä¸ªåŸºäº batch mode çš„æ¡†æ¶ã€‚</li>
<li>ç”¨ MR å†™å¤æ‚çš„åˆ†æ pipeline å¤ªéº»çƒ¦ã€‚</li>
</ol>
<p>åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œä¸€æ¬¡ MR æ‰§è¡Œæ˜¯æ²¡æ³•æŠŠäº‹æƒ…åšå®Œçš„ï¼Œéœ€è¦å¾ˆå¤šä¸ª MR ä»»åŠ¡äº’ç›¸ç»„åˆï¼Œè¿™å°±æ˜¯ MR pipeline. åœ¨æ•°æ®æµå¤æ‚çš„åˆ†æä»»åŠ¡ä¸­ï¼Œè®¾è®¡å¥½çš„ pipeline è¾¾åˆ°æœ€é«˜è¿è¡Œæ•ˆç‡å¾ˆå›°éš¾ã€‚</p>
<p>MR æœ€å¤§çš„è´¡çŒ®æˆ‘è®¤ä¸ºå°±æ˜¯ scalability å’Œ fault toleranceã€‚åœ¨ MillWheel é‡Œï¼Œç»“æœå¯ä»¥éšç€æ•°æ®æµçš„è¾“å…¥å®æ—¶çš„æ˜¾ç¤ºå‡ºæ¥ï¼Œè€Œä¸æ˜¯åˆ°æ•°æ®æµç»“æŸæ—¶æ‰è¾“å‡ºä¸€ä¸ªç»“æœï¼Œè€Œä¸”è¿™æ ·ä¸­é—´ç»“æœä¸éœ€è¦ä¿å­˜ä¸‹æ¥ã€‚</p>
<h1 id="mr-lab-in-mit6824">MR Lab in MIT6.824<a hidden class="anchor" aria-hidden="true" href="#mr-lab-in-mit6824">#</a></h1>
<p><a href="https://pdos.csail.mit.edu/6.824/labs/lab-mr.html">Check the lab-mr page here</a></p>
<p>åœ¨æœ¬å®éªŒä¸­ï¼Œæˆ‘ä»¬å°†æ„å»ºä¸€ä¸ª MapReduce ç³»ç»Ÿã€‚ æˆ‘ä»¬å°†å®ç°ä¸€ä¸ªè°ƒç”¨åº”ç”¨ç¨‹åº Map å’Œ Reduce å‡½æ•°å¹¶å¤„ç†è¯»å†™æ–‡ä»¶çš„ç¨‹åºï¼Œä»¥åŠä¸€ä¸ªå°†ä»»åŠ¡åˆ†å‘ç»™ Worker å¹¶å¤„ç†å¤±è´¥çš„ Worker çš„è¿›ç¨‹(Master)ã€‚åœ¨ MR å®éªŒä¸­ï¼Œä½¿ç”¨ Golang æ¥ç¼–ç å®ç°ã€‚</p>
<p>æˆ‘çš„å®ç°åœ¨ WSL Ubuntu20.04 ä¸Š goç‰ˆæœ¬ 1.18ã€‚</p>
<p>è¿™æ¬¡çš„è¦æ±‚è²Œä¼¼æ¯”ä»¥å‰æ›´éš¾äº†ï¼Œè¿™æ¬¡éœ€è¦ Worker ä¸»åŠ¨å‘ Master è¯·æ±‚ä»»åŠ¡ï¼Œå½“ä»»åŠ¡è¶…æ—¶åï¼Œéœ€è¦ Master æ¥é‡æ–°åˆ†é…è¿™ä¸ªä»»åŠ¡ã€‚</p>
<p>æ€»ä½“æ€è·¯å…¶å®ä¹Ÿéå¸¸çš„ç®€å•ï¼Œworker å’Œ coordinator çš„äº¤äº’éƒ½å›´ç»•ç€ RPC å±•å¼€ï¼Œæ•…å…ˆä» RPC çš„å®šä¹‰å¼€å§‹ã€‚å› ä¸ºæ·±å—äº‹ä»¶è½®è¯¢ç¼–ç¨‹æ¨¡å¼çš„&rsquo;è¼æ¯’&rsquo;ï¼Œæˆ‘æŠŠ worker å’Œ coordinator ä¹‹é—´çš„äº¤äº’è¿‡ç¨‹ä»¥äº‹ä»¶çš„å½¢å¼æ¥è¿›è¡Œå¤„ç†ã€‚é¦–å…ˆå®šä¹‰äº‹ä»¶çš„ç±»å‹ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="c1">// src/mr/rpc.go
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">TaskTp</span> <span class="p">=</span> <span class="kt">int</span>
</span></span><span class="line"><span class="cl"><span class="kd">const</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">	<span class="nx">TpRequireTask</span> <span class="p">=</span> <span class="kc">iota</span>
</span></span><span class="line"><span class="cl">	<span class="nx">TpMapTaskDone</span>
</span></span><span class="line"><span class="cl">	<span class="nx">TpReduceTaskDone</span>
</span></span><span class="line"><span class="cl">	<span class="nx">TpSendMapTask</span>
</span></span><span class="line"><span class="cl">	<span class="nx">TpSendReduceTask</span>
</span></span><span class="line"><span class="cl">	<span class="nx">TpTaskAllDone</span>
</span></span><span class="line"><span class="cl">	<span class="nx">TpWait</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></div><p>å†æ¥è€ƒè™‘ RPC éœ€è¦åœ¨ worker å’Œ coordinator ä¸­ä¼ é€’ä»€ä¹ˆä¿¡æ¯ï¼Ÿä¸è®ºä½•ç§ä¿¡æ¯ï¼Œé¦–å…ˆéƒ½éœ€è¦ä¸€ä¸ªæ—¶é—´æˆ³æ¥è®°å½• require å’Œ reply å¯¹ã€‚å…¶æ¬¡æ¯ä¸ª worker éƒ½éœ€è¦çŸ¥é“ä¸€å…±æœ‰å¤šå°‘ä¸ª Map å’Œ Reduce ä»»åŠ¡ã€‚æ¯ä¸ª require éœ€è¦è·Ÿä¸Šå½“å‰ worker çš„ä»»åŠ¡ç¼–å·ã€‚å½“ç„¶ï¼Œå› ä¸ºæ˜¯äº‹ä»¶é©±åŠ¨çš„è§’åº¦ç¼–å†™çš„ï¼Œæ‰€ä»¥æ¯æ¡ require å’Œ reply éƒ½éœ€è¦æœ‰ä¸€ä¸ªäº‹ä»¶ç±»å‹è®°å½•ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="c1">// src/mr/rpc.go
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">RequireMsg</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Stamp</span>   <span class="kt">int64</span>
</span></span><span class="line"><span class="cl">	<span class="nx">MsgFlag</span> <span class="nx">TaskTp</span>
</span></span><span class="line"><span class="cl">	<span class="nx">TaskID</span>  <span class="kt">int</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">ReplyMsg</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Stamp</span>            <span class="kt">int64</span>
</span></span><span class="line"><span class="cl">	<span class="nx">MsgFlag</span>          <span class="nx">TaskTp</span>
</span></span><span class="line"><span class="cl">	<span class="nx">TaskID</span>           <span class="kt">int</span>
</span></span><span class="line"><span class="cl">	<span class="nx">NumReduceWorkers</span> <span class="kt">int</span>
</span></span><span class="line"><span class="cl">	<span class="nx">NumMapWorkers</span>    <span class="kt">int</span>
</span></span><span class="line"><span class="cl">	<span class="nx">Content</span>          <span class="kt">string</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><hr>
<p>å¯¹äº coordinatorï¼Œå…¶ä½œç”¨åƒæ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼Œéœ€è¦ç»´æŠ¤æ‰€æœ‰çš„ worker çš„çŠ¶æ€ï¼Œå¹¶èƒ½åšåˆ°å›é€€(Fault Tolerance)ã€‚Coordinator çš„å®šä¹‰å¦‚ä¸‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="c1">// src/mr/coordinator.go
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">type</span> <span class="nx">Coordinator</span> <span class="kd">struct</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">nMapWorkers</span>       <span class="kt">int</span>
</span></span><span class="line"><span class="cl">	<span class="nx">nReduceWorkers</span>    <span class="kt">int</span>
</span></span><span class="line"><span class="cl">	<span class="nx">nMapWorking</span>       <span class="kt">int</span>
</span></span><span class="line"><span class="cl">	<span class="nx">nReduceWorking</span>    <span class="kt">int</span>
</span></span><span class="line"><span class="cl">	<span class="nx">MapWorkerState</span>    <span class="p">[]</span><span class="kt">int64</span>
</span></span><span class="line"><span class="cl">	<span class="nx">ReduceWorkerState</span> <span class="p">[]</span><span class="kt">int64</span>
</span></span><span class="line"><span class="cl">	<span class="nx">FilesContent</span>      <span class="p">[]</span><span class="kt">string</span>
</span></span><span class="line"><span class="cl">	<span class="nx">MapWorkerPool</span>     <span class="kd">chan</span> <span class="kt">int</span>
</span></span><span class="line"><span class="cl">	<span class="nx">ReduceWorkerPool</span>  <span class="kd">chan</span> <span class="kt">int</span>
</span></span><span class="line"><span class="cl">	<span class="nx">IsDone</span>            <span class="kt">bool</span>
</span></span><span class="line"><span class="cl">	<span class="nx">GlobalLock</span>        <span class="o">*</span><span class="nx">sync</span><span class="p">.</span><span class="nx">Cond</span> <span class="c1">// to make sure the rpc visit is atomic.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></div><p>coordinator éœ€è¦å¤„ç† RPC çš„è¯·æ±‚ï¼Œå¯¹äºä¸åŒçš„äº‹ä»¶è¿›è¡Œååº”ã€‚å› ä¸ºéœ€è¦è¶…æ—¶å¤„ç†ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œï¼Œæ¯ä¸€ä¸ª worker éƒ½ä¼šæœ‰ä¸€ä¸ªåç¨‹æ¥è¿›è¡Œç›¸åº”çš„è®¡æ—¶å’Œ id å›æ”¶ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="c1">// src/mr/coordinator.go
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="p">(</span><span class="nx">c</span> <span class="o">*</span><span class="nx">Coordinator</span><span class="p">)</span> <span class="nf">ProcessEvents</span><span class="p">(</span><span class="nx">args</span> <span class="o">*</span><span class="nx">RequireMsg</span><span class="p">,</span> <span class="nx">reply</span> <span class="o">*</span><span class="nx">ReplyMsg</span><span class="p">)</span> <span class="kt">error</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">c</span><span class="p">.</span><span class="nx">GlobalLock</span><span class="p">.</span><span class="nx">L</span><span class="p">.</span><span class="nf">Lock</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	<span class="nx">tmpBool</span> <span class="o">:=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">IsDone</span>
</span></span><span class="line"><span class="cl">	<span class="nx">c</span><span class="p">.</span><span class="nx">GlobalLock</span><span class="p">.</span><span class="nx">L</span><span class="p">.</span><span class="nf">Unlock</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="nx">tmpBool</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">reply</span><span class="p">.</span><span class="nx">MsgFlag</span> <span class="p">=</span> <span class="nx">TpTaskAllDone</span>
</span></span><span class="line"><span class="cl">		<span class="nx">reply</span><span class="p">.</span><span class="nx">Stamp</span> <span class="p">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">Stamp</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="kc">nil</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">switch</span> <span class="nx">args</span><span class="p">.</span><span class="nx">MsgFlag</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">case</span> <span class="nx">TpMapTaskDone</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="nx">c</span><span class="p">.</span><span class="nx">GlobalLock</span><span class="p">.</span><span class="nx">L</span><span class="p">.</span><span class="nf">Lock</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">c</span><span class="p">.</span><span class="nx">MapWorkerState</span><span class="p">[</span><span class="nx">args</span><span class="p">.</span><span class="nx">TaskID</span><span class="p">]</span> <span class="o">==</span> <span class="nx">args</span><span class="p">.</span><span class="nx">Stamp</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">c</span><span class="p">.</span><span class="nx">MapWorkerState</span><span class="p">[</span><span class="nx">args</span><span class="p">.</span><span class="nx">TaskID</span><span class="p">]</span> <span class="p">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">			<span class="nx">c</span><span class="p">.</span><span class="nx">nMapWorking</span><span class="o">--</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="nx">c</span><span class="p">.</span><span class="nx">GlobalLock</span><span class="p">.</span><span class="nx">L</span><span class="p">.</span><span class="nf">Unlock</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	<span class="k">case</span> <span class="nx">TpReduceTaskDone</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="nx">c</span><span class="p">.</span><span class="nx">GlobalLock</span><span class="p">.</span><span class="nx">L</span><span class="p">.</span><span class="nf">Lock</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">c</span><span class="p">.</span><span class="nx">ReduceWorkerState</span><span class="p">[</span><span class="nx">args</span><span class="p">.</span><span class="nx">TaskID</span><span class="p">]</span> <span class="o">==</span> <span class="nx">args</span><span class="p">.</span><span class="nx">Stamp</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">c</span><span class="p">.</span><span class="nx">ReduceWorkerState</span><span class="p">[</span><span class="nx">args</span><span class="p">.</span><span class="nx">TaskID</span><span class="p">]</span> <span class="p">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">			<span class="nx">c</span><span class="p">.</span><span class="nx">nReduceWorking</span><span class="o">--</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">c</span><span class="p">.</span><span class="nx">nReduceWorking</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">c</span><span class="p">.</span><span class="nx">IsDone</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="nx">c</span><span class="p">.</span><span class="nx">GlobalLock</span><span class="p">.</span><span class="nx">L</span><span class="p">.</span><span class="nf">Unlock</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	<span class="k">case</span> <span class="nx">TpRequireTask</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">MapWorkerPool</span><span class="p">)</span> <span class="p">&gt;</span> <span class="mi">0</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// State 1. Send Map Task to worker.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>			<span class="nx">reply</span><span class="p">.</span><span class="nx">Stamp</span> <span class="p">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">Stamp</span>
</span></span><span class="line"><span class="cl">			<span class="nx">reply</span><span class="p">.</span><span class="nx">TaskID</span> <span class="p">=</span> <span class="o">&lt;-</span><span class="nx">c</span><span class="p">.</span><span class="nx">MapWorkerPool</span>
</span></span><span class="line"><span class="cl">			<span class="nx">reply</span><span class="p">.</span><span class="nx">MsgFlag</span> <span class="p">=</span> <span class="nx">TpSendMapTask</span>
</span></span><span class="line"><span class="cl">			<span class="nx">reply</span><span class="p">.</span><span class="nx">NumMapWorkers</span> <span class="p">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">nMapWorkers</span>
</span></span><span class="line"><span class="cl">			<span class="nx">reply</span><span class="p">.</span><span class="nx">NumReduceWorkers</span> <span class="p">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">nReduceWorkers</span>
</span></span><span class="line"><span class="cl">			<span class="nx">reply</span><span class="p">.</span><span class="nx">Content</span> <span class="p">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">FilesContent</span><span class="p">[</span><span class="nx">reply</span><span class="p">.</span><span class="nx">TaskID</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">			<span class="nx">c</span><span class="p">.</span><span class="nx">GlobalLock</span><span class="p">.</span><span class="nx">L</span><span class="p">.</span><span class="nf">Lock</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">			<span class="nx">c</span><span class="p">.</span><span class="nx">MapWorkerState</span><span class="p">[</span><span class="nx">reply</span><span class="p">.</span><span class="nx">TaskID</span><span class="p">]</span> <span class="p">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">Stamp</span>
</span></span><span class="line"><span class="cl">			<span class="nx">c</span><span class="p">.</span><span class="nx">GlobalLock</span><span class="p">.</span><span class="nx">L</span><span class="p">.</span><span class="nf">Unlock</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">			<span class="k">go</span> <span class="kd">func</span><span class="p">(</span><span class="nx">id</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">time</span><span class="p">.</span><span class="nf">Sleep</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="nx">c</span><span class="p">.</span><span class="nx">GlobalLock</span><span class="p">.</span><span class="nx">L</span><span class="p">.</span><span class="nf">Lock</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">				<span class="k">if</span> <span class="nx">c</span><span class="p">.</span><span class="nx">MapWorkerState</span><span class="p">[</span><span class="nx">id</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="c1">// run out of 10 secs. recycle this id to id pool.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>					<span class="nx">c</span><span class="p">.</span><span class="nx">MapWorkerPool</span> <span class="o">&lt;-</span> <span class="nx">id</span>
</span></span><span class="line"><span class="cl">				<span class="p">}</span>
</span></span><span class="line"><span class="cl">				<span class="nx">c</span><span class="p">.</span><span class="nx">GlobalLock</span><span class="p">.</span><span class="nx">L</span><span class="p">.</span><span class="nf">Unlock</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">			<span class="p">}(</span><span class="nx">reply</span><span class="p">.</span><span class="nx">TaskID</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="kc">nil</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">c</span><span class="p">.</span><span class="nx">GlobalLock</span><span class="p">.</span><span class="nx">L</span><span class="p">.</span><span class="nf">Lock</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">			<span class="nx">nMapOnWorking</span> <span class="o">:=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">nMapWorking</span>
</span></span><span class="line"><span class="cl">			<span class="nx">nReduceOnWorking</span> <span class="o">:=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">nReduceWorking</span>
</span></span><span class="line"><span class="cl">			<span class="nx">c</span><span class="p">.</span><span class="nx">GlobalLock</span><span class="p">.</span><span class="nx">L</span><span class="p">.</span><span class="nf">Unlock</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">			<span class="c1">// State 2. All map worker is on working. wait.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>			<span class="k">if</span> <span class="nx">nMapOnWorking</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">reply</span><span class="p">.</span><span class="nx">Stamp</span> <span class="p">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">Stamp</span>
</span></span><span class="line"><span class="cl">				<span class="nx">reply</span><span class="p">.</span><span class="nx">TaskID</span> <span class="p">=</span> <span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">				<span class="nx">reply</span><span class="p">.</span><span class="nx">MsgFlag</span> <span class="p">=</span> <span class="nx">TpWait</span>
</span></span><span class="line"><span class="cl">				<span class="nx">reply</span><span class="p">.</span><span class="nx">Content</span> <span class="p">=</span> <span class="s">&#34;Just Wait !!! Map Worker !!!&#34;</span>
</span></span><span class="line"><span class="cl">				<span class="nx">reply</span><span class="p">.</span><span class="nx">NumMapWorkers</span> <span class="p">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">nMapWorkers</span>
</span></span><span class="line"><span class="cl">				<span class="nx">reply</span><span class="p">.</span><span class="nx">NumReduceWorkers</span> <span class="p">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">nReduceWorkers</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="c1">// State 3. Map is Done. Send Reduce task to works.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">ReduceWorkerPool</span><span class="p">)</span> <span class="p">&gt;</span> <span class="mi">0</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="nx">reply</span><span class="p">.</span><span class="nx">Stamp</span> <span class="p">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">Stamp</span>
</span></span><span class="line"><span class="cl">					<span class="nx">reply</span><span class="p">.</span><span class="nx">TaskID</span> <span class="p">=</span> <span class="o">&lt;-</span><span class="nx">c</span><span class="p">.</span><span class="nx">ReduceWorkerPool</span>
</span></span><span class="line"><span class="cl">					<span class="nx">reply</span><span class="p">.</span><span class="nx">MsgFlag</span> <span class="p">=</span> <span class="nx">TpSendReduceTask</span>
</span></span><span class="line"><span class="cl">					<span class="nx">reply</span><span class="p">.</span><span class="nx">Content</span> <span class="p">=</span> <span class="s">&#34;Reduce no need to handle this&#34;</span>
</span></span><span class="line"><span class="cl">					<span class="nx">reply</span><span class="p">.</span><span class="nx">NumMapWorkers</span> <span class="p">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">nMapWorkers</span>
</span></span><span class="line"><span class="cl">					<span class="nx">reply</span><span class="p">.</span><span class="nx">NumReduceWorkers</span> <span class="p">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">nReduceWorkers</span>
</span></span><span class="line"><span class="cl">					<span class="nx">c</span><span class="p">.</span><span class="nx">GlobalLock</span><span class="p">.</span><span class="nx">L</span><span class="p">.</span><span class="nf">Lock</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">					<span class="nx">c</span><span class="p">.</span><span class="nx">ReduceWorkerState</span><span class="p">[</span><span class="nx">reply</span><span class="p">.</span><span class="nx">TaskID</span><span class="p">]</span> <span class="p">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">Stamp</span>
</span></span><span class="line"><span class="cl">					<span class="nx">c</span><span class="p">.</span><span class="nx">GlobalLock</span><span class="p">.</span><span class="nx">L</span><span class="p">.</span><span class="nf">Unlock</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">					<span class="k">go</span> <span class="kd">func</span><span class="p">(</span><span class="nx">id</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">						<span class="nx">time</span><span class="p">.</span><span class="nf">Sleep</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">						<span class="nx">c</span><span class="p">.</span><span class="nx">GlobalLock</span><span class="p">.</span><span class="nx">L</span><span class="p">.</span><span class="nf">Lock</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">						<span class="k">if</span> <span class="nx">c</span><span class="p">.</span><span class="nx">ReduceWorkerState</span><span class="p">[</span><span class="nx">id</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">							<span class="c1">// run out of 10 secs. resolved this id to id pool.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>							<span class="nx">c</span><span class="p">.</span><span class="nx">ReduceWorkerPool</span> <span class="o">&lt;-</span> <span class="nx">id</span>
</span></span><span class="line"><span class="cl">						<span class="p">}</span>
</span></span><span class="line"><span class="cl">						<span class="nx">c</span><span class="p">.</span><span class="nx">GlobalLock</span><span class="p">.</span><span class="nx">L</span><span class="p">.</span><span class="nf">Unlock</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">					<span class="p">}(</span><span class="nx">reply</span><span class="p">.</span><span class="nx">TaskID</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="c1">// State 4. All reduce worker is on working. wait.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>					<span class="k">if</span> <span class="nx">nReduceOnWorking</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">						<span class="nx">reply</span><span class="p">.</span><span class="nx">Stamp</span> <span class="p">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">Stamp</span>
</span></span><span class="line"><span class="cl">						<span class="nx">reply</span><span class="p">.</span><span class="nx">TaskID</span> <span class="p">=</span> <span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">						<span class="nx">reply</span><span class="p">.</span><span class="nx">MsgFlag</span> <span class="p">=</span> <span class="nx">TpWait</span>
</span></span><span class="line"><span class="cl">						<span class="nx">reply</span><span class="p">.</span><span class="nx">Content</span> <span class="p">=</span> <span class="s">&#34;Just Wait !!! Reduce Worker !!!&#34;</span>
</span></span><span class="line"><span class="cl">						<span class="nx">reply</span><span class="p">.</span><span class="nx">NumMapWorkers</span> <span class="p">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">nMapWorkers</span>
</span></span><span class="line"><span class="cl">						<span class="nx">reply</span><span class="p">.</span><span class="nx">NumReduceWorkers</span> <span class="p">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">nReduceWorkers</span>
</span></span><span class="line"><span class="cl">					<span class="p">}</span>
</span></span><span class="line"><span class="cl">				<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">default</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="k">return</span> <span class="kc">nil</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="kc">nil</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>åŒæ ·çš„ï¼Œåœ¨ worker ä¸­çš„æµç¨‹ä¹Ÿæ˜¯ä¸æ–­çš„å¾ªç¯äº§ç”Ÿäº‹ä»¶ï¼Œå¤„ç†äº‹ä»¶</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="line"><span class="cl"><span class="c1">// src/mr/worker.go
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kd">func</span> <span class="nf">Worker</span><span class="p">(</span><span class="nx">mapf</span> <span class="kd">func</span><span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">)</span> <span class="p">[]</span><span class="nx">KeyValue</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	<span class="nx">reducef</span> <span class="kd">func</span><span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="p">[]</span><span class="kt">string</span><span class="p">)</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="kc">true</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">ThisStamp</span> <span class="o">:=</span> <span class="nx">time</span><span class="p">.</span><span class="nf">Now</span><span class="p">().</span><span class="nf">Unix</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">		<span class="nx">Req</span> <span class="o">:=</span> <span class="nx">RequireMsg</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">		<span class="nx">Req</span><span class="p">.</span><span class="nx">Stamp</span> <span class="p">=</span> <span class="nx">ThisStamp</span>
</span></span><span class="line"><span class="cl">		<span class="nx">Req</span><span class="p">.</span><span class="nx">MsgFlag</span> <span class="p">=</span> <span class="nx">TpRequireTask</span>
</span></span><span class="line"><span class="cl">		<span class="nx">Req</span><span class="p">.</span><span class="nx">TaskID</span> <span class="p">=</span> <span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">		<span class="nx">Rep</span> <span class="o">:=</span> <span class="nx">ReplyMsg</span><span class="p">{}</span>
</span></span><span class="line"><span class="cl">		<span class="nx">ok</span> <span class="o">:=</span> <span class="nf">call</span><span class="p">(</span><span class="s">&#34;Coordinator.ProcessEvents&#34;</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">Req</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">Rep</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="nx">ok</span> <span class="o">&amp;&amp;</span> <span class="nx">Rep</span><span class="p">.</span><span class="nx">Stamp</span> <span class="o">==</span> <span class="nx">Req</span><span class="p">.</span><span class="nx">Stamp</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">switch</span> <span class="nx">Rep</span><span class="p">.</span><span class="nx">MsgFlag</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">case</span> <span class="nx">TpSendMapTask</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">				<span class="nf">doMap</span><span class="p">(</span><span class="nx">mapf</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">Rep</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">case</span> <span class="nx">TpSendReduceTask</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">				<span class="nf">doReduce</span><span class="p">(</span><span class="nx">reducef</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">Rep</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">case</span> <span class="nx">TpWait</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">				<span class="nx">time</span><span class="p">.</span><span class="nf">Sleep</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">case</span> <span class="nx">TpTaskAllDone</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">				<span class="k">return</span>
</span></span><span class="line"><span class="cl">			<span class="k">default</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">				<span class="k">return</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><code>doMap(mapf, &amp;Rep)</code> å’Œ <code>doReduce(reducef, &amp;Rep)</code> å°±æ˜¯éå¸¸ç®€å•çš„é€»è¾‘ç¼–å†™äº†ã€‚Mapéœ€è¦æŠŠæ–‡ä»¶åˆ†æ‹†åˆ°<code>N=numReduce</code>å—ä¸­ï¼Œæ€»å…±äº§ç”Ÿ<code>N * M(reduce num, map num)</code>å—æ–‡ä»¶ã€‚Reduce workerä»è‡ªå·±å¯¹åº”çš„ç¼–å·ä¸­å–å‡º<code>M</code>å—è¿›è¡Œæ’åºå’Œåˆå¹¶ã€‚</p>
<hr>
<p>ç»“æœé¡ºåˆ©é€šè¿‡ï¼Œæ²¡æœ‰è¿‡å¤šçš„å»¶è¿Ÿ(å› ä¸º10sçš„åˆ¤æ–­)äº§ç”Ÿã€‚</p>
<figure>
    <img loading="lazy" src="test-mr-pass.png"/> <figcaption>
            Fig 2. test mr
        </figcaption>
</figure>

<h1 id="reference">Reference<a hidden class="anchor" aria-hidden="true" href="#reference">#</a></h1>
<p>[1] &ldquo;MapReduce: Simplified Data Processing on Large Clusters&rdquo; googleusercontent.com.</p>
<p>[2] <a href="https://cloudplatform.googleblog.com/2014/06/reimagining-developer-productivity-and-data-analytics-in-the-cloud-news-from-google-io.html">Google cloud blog about MapReduce&rsquo;s successor</a></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="https://chenghuawang.github.io/keep-moving-forward/papers/gfs/">
    <span class="title">Â« Prev</span>
    <br>
    <span>Google File System(GFS)</span>
  </a>
  <a class="next" href="https://chenghuawang.github.io/keep-moving-forward/tech/fundamental_quantization/">
    <span class="title">Next Â»</span>
    <br>
    <span></span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share MapReduce on x"
            href="https://x.com/intent/tweet/?text=MapReduce&amp;url=https%3a%2f%2fchenghuawang.github.io%2fkeep-moving-forward%2fpapers%2fmapreduce%2f&amp;hashtags=">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share MapReduce on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fchenghuawang.github.io%2fkeep-moving-forward%2fpapers%2fmapreduce%2f&amp;title=MapReduce&amp;summary=MapReduce&amp;source=https%3a%2f%2fchenghuawang.github.io%2fkeep-moving-forward%2fpapers%2fmapreduce%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share MapReduce on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2fchenghuawang.github.io%2fkeep-moving-forward%2fpapers%2fmapreduce%2f&title=MapReduce">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share MapReduce on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fchenghuawang.github.io%2fkeep-moving-forward%2fpapers%2fmapreduce%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share MapReduce on whatsapp"
            href="https://api.whatsapp.com/send?text=MapReduce%20-%20https%3a%2f%2fchenghuawang.github.io%2fkeep-moving-forward%2fpapers%2fmapreduce%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share MapReduce on telegram"
            href="https://telegram.me/share/url?text=MapReduce&amp;url=https%3a%2f%2fchenghuawang.github.io%2fkeep-moving-forward%2fpapers%2fmapreduce%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share MapReduce on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=MapReduce&u=https%3a%2f%2fchenghuawang.github.io%2fkeep-moving-forward%2fpapers%2fmapreduce%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>Â© <a href="https://github.com/chenghuaWang">chenghua.wang</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a><script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js" integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script>
const images = Array.from(document.querySelectorAll(".post-content img"));
images.forEach(img => {
  mediumZoom(img, {
    margin: 0,  
    scrollOffset: 40,  
    container: null,  
    template: null,  
    background: 'rgba(0, 0, 0, 0.8)'
  });
});
</script>
<script type="text/javascript" src="//rf.revolvermaps.com/0/0/8.js?i=5j20jf9ml5x&amp;m=0&amp;c=ff0000&amp;cr1=ffffff&amp;f=arial&amp;l=33" async="async"></script>


<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
