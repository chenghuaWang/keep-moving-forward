<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>MapReduce - Ubios Home</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="MapReduce" />
<meta property="og:description" content="OSDI&#39;04: 6th Symposium on Operating Systems Design and Implementation
go back to home
Paper link
ä»€ä¹ˆæ˜¯ MapReduce åœ¨MapReduceåŸæ–‡ä¸­æ˜¯è¿™ä¹ˆè¯´çš„
MapReduce is a programming model and an associated implementation for processing and generating large data sets. [1]
è¿™æ˜¯ä¸€ä¸ªè¾ƒä¸ºç®€å•çš„å¤„ç†å¤§å‹é—®é¢˜çš„åˆ†å¸ƒå¼ç¼–ç¨‹æ¨¡å‹ã€‚å…¶äº§ç”Ÿçš„åŸå› æ˜¯å› ä¸º google æƒ³è¦è®©æ™®é€šçš„ç¨‹åºå‘˜ä¹Ÿèƒ½å¤Ÿé€šè¿‡ä¸€å¥—ç®€å•çš„ç¼–ç¨‹æ¨¡å‹æ¥ç¼–å†™åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºï¼Œä»¥æ­¤æ¥å¤„ç† google å†…éƒ¨çš„å¤§æ•°æ®ã€‚ç„¶åè‘—åçš„ Jeff Dean å’Œ Sanjay Ghemawat å‡ºé©¬æå®šäº†è¿™ä¸ªé—®é¢˜(åœ¨çŸ¥ä¹ä¸Šå…³äºJeff Deançš„è½¶äº‹:-))ã€‚MapReduce åœ¨ google å†…éƒ¨è¿è¡Œå¾ˆé•¿çš„æ—¶é—´å¹¶ä¸”å¤„ç†äº†å¾ˆå¤šä¸šåŠ¡ï¼Œä½†æ˜¯ç›®å‰ä¹Ÿè´¥ä¸‹é˜µæ¥ï¼Œå…·ä½“åŸå› å‚è§ MapReduce ç¼ºé™·ç« èŠ‚(MRæ—©åœ¨2004å¹´å°±å‡ºæ¥äº†ï¼Œå…¶å®æ˜¯å¤æ—©çš„æŠ€æœ¯äº†ï¼Œå…¶æ²¡æœ‰åœ¨æ€§èƒ½ä¸Šåšæ–‡ç« ï¼Œä¸»è¦åœ¨å¯æ‰©å±•æ€§ä¸Š)ã€‚
MapReduce çš„è®¾è®¡æ¡†æ¶å’ŒåŸºæœ¬æµç¨‹ MRå®é™…ä¸Šæ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„æ¡†æ¶ï¼Œæ€è·¯ä¹Ÿéå¸¸çš„ç›´ç™½ã€‚MapReduce èƒŒåçš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†æ•°æ®é›†æ˜ å°„åˆ°ä¸€ä¸ª &lt;key, value&gt; pairçš„é›†åˆä¸­ï¼Œç„¶åä½¿ç”¨ç›¸åŒçš„é”®å¯¹æ‰€æœ‰pairè¿›è¡Œæ•´åˆã€‚ æ•´ä½“æ¦‚å¿µå¾ˆç®€å•ï¼Œä½†æ˜¯å¦‚æœä½ è®¾æƒ³ä¸‹ä¸‹é¢çš„æƒ…å†µï¼ŒMRå®é™…ä¸Šéå¸¸æœ‰ç”¨: åŸºæœ¬ä¸Šæ‰€æœ‰çš„æ•°æ®éƒ½èƒ½è¢«æ˜ å°„åˆ°ä¸€ä¸ª &lt;key, value&gt; å¯¹ä¸­ï¼Œå¹¶ä¸”keyå’Œvalueå¯ä»¥æ˜¯ä»»æ„ç±»å‹ã€‚
åœ¨è®ºæ–‡ä¸­MRä½¿ç”¨çš„æ ·ä¾‹æ˜¯åœ¨è¶…å¤§çš„æ–‡ä»¶é‡Œåšå•è¯ç»Ÿè®¡ã€‚è¿™ä¸ªæ¡†æ¶è¿˜å¯ä»¥ç”¨æ¥åšï¼š
åˆ†å¸ƒå¼çš„æ’åº åˆ†å¸ƒå¼çš„æœç´¢ Webé“¾æ¥å›¾éå† &hellip; Fig 1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://chenghuawang.github.io/keep-moving-forward/papers/mapreduce/" /><meta property="article:section" content="Papers" />
<meta property="article:published_time" content="2023-01-17T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-01-17T00:00:00+00:00" />

		<meta itemprop="name" content="MapReduce">
<meta itemprop="description" content="OSDI&#39;04: 6th Symposium on Operating Systems Design and Implementation
go back to home
Paper link
ä»€ä¹ˆæ˜¯ MapReduce åœ¨MapReduceåŸæ–‡ä¸­æ˜¯è¿™ä¹ˆè¯´çš„
MapReduce is a programming model and an associated implementation for processing and generating large data sets. [1]
è¿™æ˜¯ä¸€ä¸ªè¾ƒä¸ºç®€å•çš„å¤„ç†å¤§å‹é—®é¢˜çš„åˆ†å¸ƒå¼ç¼–ç¨‹æ¨¡å‹ã€‚å…¶äº§ç”Ÿçš„åŸå› æ˜¯å› ä¸º google æƒ³è¦è®©æ™®é€šçš„ç¨‹åºå‘˜ä¹Ÿèƒ½å¤Ÿé€šè¿‡ä¸€å¥—ç®€å•çš„ç¼–ç¨‹æ¨¡å‹æ¥ç¼–å†™åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºï¼Œä»¥æ­¤æ¥å¤„ç† google å†…éƒ¨çš„å¤§æ•°æ®ã€‚ç„¶åè‘—åçš„ Jeff Dean å’Œ Sanjay Ghemawat å‡ºé©¬æå®šäº†è¿™ä¸ªé—®é¢˜(åœ¨çŸ¥ä¹ä¸Šå…³äºJeff Deançš„è½¶äº‹:-))ã€‚MapReduce åœ¨ google å†…éƒ¨è¿è¡Œå¾ˆé•¿çš„æ—¶é—´å¹¶ä¸”å¤„ç†äº†å¾ˆå¤šä¸šåŠ¡ï¼Œä½†æ˜¯ç›®å‰ä¹Ÿè´¥ä¸‹é˜µæ¥ï¼Œå…·ä½“åŸå› å‚è§ MapReduce ç¼ºé™·ç« èŠ‚(MRæ—©åœ¨2004å¹´å°±å‡ºæ¥äº†ï¼Œå…¶å®æ˜¯å¤æ—©çš„æŠ€æœ¯äº†ï¼Œå…¶æ²¡æœ‰åœ¨æ€§èƒ½ä¸Šåšæ–‡ç« ï¼Œä¸»è¦åœ¨å¯æ‰©å±•æ€§ä¸Š)ã€‚
MapReduce çš„è®¾è®¡æ¡†æ¶å’ŒåŸºæœ¬æµç¨‹ MRå®é™…ä¸Šæ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„æ¡†æ¶ï¼Œæ€è·¯ä¹Ÿéå¸¸çš„ç›´ç™½ã€‚MapReduce èƒŒåçš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†æ•°æ®é›†æ˜ å°„åˆ°ä¸€ä¸ª &lt;key, value&gt; pairçš„é›†åˆä¸­ï¼Œç„¶åä½¿ç”¨ç›¸åŒçš„é”®å¯¹æ‰€æœ‰pairè¿›è¡Œæ•´åˆã€‚ æ•´ä½“æ¦‚å¿µå¾ˆç®€å•ï¼Œä½†æ˜¯å¦‚æœä½ è®¾æƒ³ä¸‹ä¸‹é¢çš„æƒ…å†µï¼ŒMRå®é™…ä¸Šéå¸¸æœ‰ç”¨: åŸºæœ¬ä¸Šæ‰€æœ‰çš„æ•°æ®éƒ½èƒ½è¢«æ˜ å°„åˆ°ä¸€ä¸ª &lt;key, value&gt; å¯¹ä¸­ï¼Œå¹¶ä¸”keyå’Œvalueå¯ä»¥æ˜¯ä»»æ„ç±»å‹ã€‚
åœ¨è®ºæ–‡ä¸­MRä½¿ç”¨çš„æ ·ä¾‹æ˜¯åœ¨è¶…å¤§çš„æ–‡ä»¶é‡Œåšå•è¯ç»Ÿè®¡ã€‚è¿™ä¸ªæ¡†æ¶è¿˜å¯ä»¥ç”¨æ¥åšï¼š
åˆ†å¸ƒå¼çš„æ’åº åˆ†å¸ƒå¼çš„æœç´¢ Webé“¾æ¥å›¾éå† &hellip; Fig 1."><meta itemprop="datePublished" content="2023-01-17T00:00:00+00:00" />
<meta itemprop="dateModified" content="2023-01-17T00:00:00+00:00" />
<meta itemprop="wordCount" content="952">
<meta itemprop="keywords" content="" />
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans+SC:400,700">

	<link rel="stylesheet" href="/keep-moving-forward/css/style.css">
	

	<link rel="shortcut icon" href="/keep-moving-forward/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		
<header class="header">
	<div class="container header__container">
		
	<div class="logo logo--mixed" >
		<a class="logo__link" href="/keep-moving-forward/" title="Ubios Home" rel="home" >
			
			<div class="logo__item logo__text" >
					<div class="logo__title" >Ubios Home</div>
					<div class="logo__tagline">Remember brick walls let us show our dedication. They are there to separate us from the people who don&#39;t really want to achieve their childhood dreams. --Randy Pausch</div>
				</div>
		</a>
	</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">Menu</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/keep-moving-forward/about/about/">
				
				<span class="menu__text">About</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/keep-moving-forward/about/hpc_ai/">
				
				<span class="menu__text">HPC &amp; AI å…¥å‘</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/keep-moving-forward/about/lecture_notes/">
				
				<span class="menu__text">Lecture-Notes</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/keep-moving-forward/about/paper_posts/">
				
				<span class="menu__text">Paper-Notes</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/keep-moving-forward/about/tech_posts/">
				
				<span class="menu__text">Tech-Posts</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/keep-moving-forward/about/thinking/">
				
				<span class="menu__text">Thinking</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/keep-moving-forward/about/news/">
				
				<span class="menu__text">ğŸ‰NewsğŸ‰</span>
				
			</a>
		</li>
	</ul>
</nav>

	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			


<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">MapReduce</h1>
			<p class="post__lead">notes of paper, OSDI&#39;04: 6th Symposium on Operating Systems Design and Implementation</p>
			<div class="post__meta meta"><div class="meta__item-author meta__item">
	<svg class="meta__icon icon icon-author" width="16" height="16" viewBox="0 0 12 16"><path d="M6 1c2.2 0 3.5 2 3.5 4.5C9.5 7 8.9 8.2 8 9c2.9.8 4 2.5 4 5v1H0v-1c0-2.5 1.1-4.2 4-5-.9-.8-1.5-2-1.5-3.5C2.5 3 3.8 1 6 1z"/></svg><span class="meta__text">chenghua.wang</span>
</div>
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class="meta__text" datetime="2023-01-17T00:00:00Z">2023-01-17</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg><span class="meta__text"><a class="meta__link" href="/keep-moving-forward/categories/distributed-sys/" rel="category">distributed sys</a>
	</span>
</div></div>
		</header>

		
<div class="post__toc toc">
	<div class="toc__title">Page content</div>
	<div class="toc__menu">
		<nav id="TableOfContents">
  <ul>
    <li><a href="#ä»€ä¹ˆæ˜¯-mapreduce">ä»€ä¹ˆæ˜¯ MapReduce</a>
      <ul>
        <li><a href="#mapreduce-çš„è®¾è®¡æ¡†æ¶å’ŒåŸºæœ¬æµç¨‹">MapReduce çš„è®¾è®¡æ¡†æ¶å’ŒåŸºæœ¬æµç¨‹</a></li>
      </ul>
    </li>
    <li><a href="#mapreduce-çš„ä½¿ç”¨èŒƒä¾‹">MapReduce çš„ä½¿ç”¨èŒƒä¾‹</a></li>
    <li><a href="#mr-fault-tolerance">MR Fault Tolerance</a>
      <ul>
        <li><a href="#worker-failure">Worker Failure</a></li>
        <li><a href="#master-failure">Master Failure</a></li>
      </ul>
    </li>
    <li><a href="#mr-ç¼ºé™·">MR ç¼ºé™·</a></li>
    <li><a href="#mr-lab-in-mit6824">MR Lab in MIT6.824</a></li>
    <li><a href="#reference">Reference</a></li>
  </ul>
</nav>
	</div>
</div><div class="content post__content clearfix">
			<p>OSDI'04: 6th Symposium on Operating Systems Design and Implementation</p>
<p><a href="/">go back to home</a></p>
<p><a href="https://pdos.csail.mit.edu/6.824/papers/mapreduce.pdf">Paper link</a></p>
<hr>
<h1 id="ä»€ä¹ˆæ˜¯-mapreduce">ä»€ä¹ˆæ˜¯ MapReduce</h1>
<p>åœ¨MapReduceåŸæ–‡ä¸­æ˜¯è¿™ä¹ˆè¯´çš„</p>
<blockquote>
<p>MapReduce is a programming model and an associated implementation for processing and generating large data sets. [1]</p>
</blockquote>
<p>è¿™æ˜¯ä¸€ä¸ªè¾ƒä¸ºç®€å•çš„å¤„ç†å¤§å‹é—®é¢˜çš„åˆ†å¸ƒå¼ç¼–ç¨‹æ¨¡å‹ã€‚å…¶äº§ç”Ÿçš„åŸå› æ˜¯å› ä¸º google æƒ³è¦è®©æ™®é€šçš„ç¨‹åºå‘˜ä¹Ÿèƒ½å¤Ÿé€šè¿‡ä¸€å¥—ç®€å•çš„ç¼–ç¨‹æ¨¡å‹æ¥ç¼–å†™åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºï¼Œä»¥æ­¤æ¥å¤„ç† google å†…éƒ¨çš„å¤§æ•°æ®ã€‚ç„¶åè‘—åçš„ Jeff Dean å’Œ Sanjay Ghemawat å‡ºé©¬æå®šäº†è¿™ä¸ªé—®é¢˜(<a href="https://www.zhihu.com/question/22081653">åœ¨çŸ¥ä¹ä¸Šå…³äºJeff Deançš„è½¶äº‹:-)</a>)ã€‚MapReduce åœ¨ google å†…éƒ¨è¿è¡Œå¾ˆé•¿çš„æ—¶é—´å¹¶ä¸”å¤„ç†äº†å¾ˆå¤šä¸šåŠ¡ï¼Œä½†æ˜¯ç›®å‰ä¹Ÿè´¥ä¸‹é˜µæ¥ï¼Œå…·ä½“åŸå› å‚è§ MapReduce ç¼ºé™·ç« èŠ‚(MRæ—©åœ¨2004å¹´å°±å‡ºæ¥äº†ï¼Œå…¶å®æ˜¯å¤æ—©çš„æŠ€æœ¯äº†ï¼Œå…¶æ²¡æœ‰åœ¨æ€§èƒ½ä¸Šåšæ–‡ç« ï¼Œä¸»è¦åœ¨å¯æ‰©å±•æ€§ä¸Š)ã€‚</p>
<h2 id="mapreduce-çš„è®¾è®¡æ¡†æ¶å’ŒåŸºæœ¬æµç¨‹">MapReduce çš„è®¾è®¡æ¡†æ¶å’ŒåŸºæœ¬æµç¨‹</h2>
<p>MRå®é™…ä¸Šæ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„æ¡†æ¶ï¼Œæ€è·¯ä¹Ÿéå¸¸çš„ç›´ç™½ã€‚MapReduce èƒŒåçš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†æ•°æ®é›†æ˜ å°„åˆ°ä¸€ä¸ª <code>&lt;key, value&gt;</code> pairçš„é›†åˆä¸­ï¼Œç„¶åä½¿ç”¨ç›¸åŒçš„é”®å¯¹æ‰€æœ‰pairè¿›è¡Œæ•´åˆã€‚ æ•´ä½“æ¦‚å¿µå¾ˆç®€å•ï¼Œä½†æ˜¯å¦‚æœä½ è®¾æƒ³ä¸‹ä¸‹é¢çš„æƒ…å†µï¼ŒMRå®é™…ä¸Šéå¸¸æœ‰ç”¨: åŸºæœ¬ä¸Šæ‰€æœ‰çš„æ•°æ®éƒ½èƒ½è¢«æ˜ å°„åˆ°ä¸€ä¸ª <code>&lt;key, value&gt;</code> å¯¹ä¸­ï¼Œå¹¶ä¸”keyå’Œvalueå¯ä»¥æ˜¯ä»»æ„ç±»å‹ã€‚</p>
<p>åœ¨è®ºæ–‡ä¸­MRä½¿ç”¨çš„æ ·ä¾‹æ˜¯åœ¨è¶…å¤§çš„æ–‡ä»¶é‡Œåšå•è¯ç»Ÿè®¡ã€‚è¿™ä¸ªæ¡†æ¶è¿˜å¯ä»¥ç”¨æ¥åšï¼š</p>
<ol>
<li>åˆ†å¸ƒå¼çš„æ’åº</li>
<li>åˆ†å¸ƒå¼çš„æœç´¢</li>
<li>Webé“¾æ¥å›¾éå†</li>
<li>&hellip;</li>
</ol>
<hr>
<div align="center"> 
<img src="/keep-moving-forward/imgs/MapReduceArch.png" width = "80%"/>
<br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">Fig 1. MapReduce Arch(ref [1])</div>
</div>
<p>MR ä¸­çš„Mapå’ŒReduceæ˜¯ä»å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€(LISP)ä¸­å€Ÿé‰´è¿‡æ¥çš„ä¸€ä¸ªæ¦‚å¿µã€‚ç¨‹åºå‘˜åªéœ€è¦ç¼–å†™Mapå’ŒReduceä¸¤ä¸ªå‡½æ•°å°±èƒ½å¤Ÿå¯¹æŸä¸ªä»»åŠ¡å¹¶å‘å¤„ç†ã€‚åœ¨ Fig 1 ä¸­ï¼ŒMRä¸»è¦çš„æµç¨‹åˆ†ä¸º6ä¸ªéƒ¨åˆ†</p>
<ol>
<li>
<p>ç”¨æˆ·ç¨‹åºçš„MRé¦–å…ˆå°†è¾“å…¥æ–‡ä»¶åˆ†æˆ M å—ï¼Œæ¯å—é€šå¸¸ä¸º 16 MBåˆ° 64 MB(å¯ç”±ç”¨æˆ·é€šè¿‡å‚æ•°æ§åˆ¶)ã€‚ ç„¶åï¼Œå®ƒä¼šåœ¨ä¸€ç»„æœºå™¨ä¸Šå¯åŠ¨è¯¥ç¨‹åºçš„å¤šä¸ªå‰¯æœ¬ã€‚</p>
</li>
<li>
<p>è¿™äº›å‰¯æœ¬ä¸­æœ‰ä¸€ä¸ªæ§åˆ¶ç¨‹åº(Master)ã€‚å…¶ä½™çš„ç¨‹åº(Worker)ç”±æ§åˆ¶ç¨‹åº(Master)æ¥åˆ†é…ã€‚æœ‰ M ä¸ª Map ä»»åŠ¡å’Œ R ä¸ª Reduce ä»»åŠ¡è¦åˆ†é…ã€‚Master æŒ‘é€‰ç©ºé—²çš„ Worker å¹¶ä¸ºæ¯ä¸ªæœºå™¨åˆ†é…ä¸€ä¸ª Map ä»»åŠ¡æˆ– Reduce ä»»åŠ¡ã€‚</p>
</li>
<li>
<p>åˆ†é…äº† map ä»»åŠ¡çš„ worker è¯»å–ç›¸åº”çš„å†…å®¹(æ‹†åˆ†åçš„æ–‡ä»¶å—)(è®¾æƒ³ä¸‹ï¼Œå¦‚æœè¿™é‡Œçš„æ–‡ä»¶è¯»å–éœ€è¦ä»æ•°æ®ä»“åº“ä¸­æ‹¿å‡ºï¼Œé‚£ä¹ˆæ•´ä¸ªæ¡†æ¶çš„è®¡ç®—èƒ½åŠ›æå¤§çš„è¢«ç½‘ç»œæ‰€é™åˆ¶äº†)ã€‚å®ƒä»è¾“å…¥æ•°æ®ä¸­è§£æå‡º<code>&lt;key, value&gt;</code>å¯¹ï¼Œå¹¶å°†æ¯ä¸€å¯¹ä¼ é€’ç»™ç”¨æˆ·å®šä¹‰çš„ Map å‡½æ•°ã€‚ Map å‡½æ•°äº§ç”Ÿçš„ä¸­é—´<code>&lt;key, value&gt;</code>å¯¹è¢«ç¼“å­˜åœ¨å†…å­˜ä¸­ã€‚</p>
</li>
<li>
<p>ç¼“å­˜åœ¨æœºå™¨ä¸­çš„ä¸­é—´<code>&lt;key, value&gt;</code>å¯¹å‘¨æœŸæ€§åœ°è¢«å†™å…¥æœ¬åœ°ç£ç›˜ï¼Œç”±åˆ†åŒºå‡½æ•°åˆ’åˆ†ä¸º R ä¸ªåŒºåŸŸã€‚è¿™äº›ç¼“å†²å¯¹åœ¨æœ¬åœ°ç£ç›˜ä¸Šçš„ä½ç½®è¢«ä¼ å› Masterï¼ŒMaster è´Ÿè´£å°†è¿™äº›ä½ç½®è½¬å‘ç»™ Reduce Workerã€‚</p>
</li>
<li>
<p>å½“ Master é€šçŸ¥ Reduce Worker æœ‰å…³è¿™äº›ä½ç½®æ—¶ï¼Œå®ƒä¼šä½¿ç”¨RPCä» Map Worker çš„æœ¬åœ°ç£ç›˜è¯»å–ç¼“å†²æ•°æ®ã€‚å½“ Reduce Worker è¯»å–æ‰€æœ‰ä¸­é—´æ•°æ®æ—¶ï¼Œå®ƒä¼šæŒ‰ä¸­é—´é”®å¯¹å…¶è¿›è¡Œæ’åºï¼Œä»¥ä¾¿å°†æ‰€æœ‰å‡ºç°çš„ç›¸åŒé”®ç»„åˆåœ¨ä¸€èµ·ã€‚æ’åºæ˜¯å› ä¸ºé€šå¸¸è®¸å¤šä¸åŒçš„é”®æ˜ å°„åˆ°åŒä¸€ä¸ª Reduce ä»»åŠ¡ã€‚å¦‚æœä¸­é—´æ•°æ®é‡å¤ªå¤§è€Œæ— æ³•æ”¾å…¥å†…å­˜ï¼Œåˆ™ä½¿ç”¨å¤–éƒ¨æ’åºã€‚</p>
</li>
<li>
<p>Reduce Worker è¿­ä»£æ’åºçš„ä¸­é—´æ•°æ®ï¼Œå¯¹äºé‡åˆ°çš„æ¯ä¸ªå”¯ä¸€ä¸­é—´é”®ï¼Œå®ƒå°†é”®å’Œç›¸åº”çš„ä¸­é—´å€¼é›†ä¼ é€’ç»™ç”¨æˆ·çš„ Reduce å‡½æ•°ã€‚Reduce å‡½æ•°çš„è¾“å‡ºåˆ°æ­¤ Reduce åˆ†åŒºçš„æœ€ç»ˆè¾“å‡ºæ–‡ä»¶ã€‚</p>
</li>
<li>
<p>å½“æ‰€æœ‰çš„ Map ä»»åŠ¡å’Œ Reduce ä»»åŠ¡éƒ½å®Œæˆåï¼ŒMasterå”¤é†’ç”¨æˆ·ç¨‹åºã€‚æ­¤æ—¶ç”¨æˆ·ç¨‹åºä¸­çš„ MR è°ƒç”¨è¿”å›ç»™ç”¨æˆ·ä»£ç </p>
</li>
</ol>
<p>å› ä¸ºç½‘ç»œä¸Šçš„æ•°æ®äº¤æ¢æ˜¯éå¸¸ç¼“æ…¢çš„ï¼Œä½œè€…åœ¨åˆ†å‘æ•°æ®çš„æ—¶å€™å°½é‡ä¿è¯æ•°æ®å°±åœ¨è¿™å°è®¡ç®—æœåŠ¡å™¨ä¸Šï¼Œè€Œä¸éœ€è¦ä¼ è¾“æ•°æ®ã€‚åœ¨åŸæ–‡ä¸­æ˜¯è¿™æ ·è¯´çš„ï¼š</p>
<blockquote>
<p>We conserve network bandwidth by taking advantage of the fact that the input data (managed by GFS) is stored on the local disks of the
machines that make up our cluster.</p>
</blockquote>
<h1 id="mapreduce-çš„ä½¿ç”¨èŒƒä¾‹">MapReduce çš„ä½¿ç”¨èŒƒä¾‹</h1>
<p>è®ºæ–‡ä¸­ï¼Œä»¥è¯é¢‘ç»Ÿè®¡ä¸ºä¾‹å­ï¼Œå¦‚è®ºæ–‡ä¸­çš„ä¼ªä»£ç ï¼š</p>
<pre tabindex="0"><code>map(String key, String value):
    // key: document name
    // value: document contents
    for each word w in value:
        EmitIntermediate(w, &#34;1&#34;);
</code></pre><pre tabindex="0"><code>reduce(String key, Iterator values):
    // key: a word
    // values: a list of counts
    int result = 0;
    for each v in values:
        result += ParseInt(v);
        Emit(AsString(result));
</code></pre><h1 id="mr-fault-tolerance">MR Fault Tolerance</h1>
<p>Fault Tolerance åœ¨åˆ†å¸ƒå¼ç¨‹åºä¸­æ˜¯éå¸¸é‡è¦çš„ã€‚MR ä¸»è¦çš„è´¡çŒ®ç‚¹å…¶å®å°±åœ¨ scalability å’Œ fault toleranceã€‚</p>
<h2 id="worker-failure">Worker Failure</h2>
<p>Master ä¼šå®šæœŸçš„ ping Worker æœåŠ¡å™¨ï¼Œå¦‚æœä¸é€šï¼Œé‚£ä¹ˆè¿™ä¸ª Worker è¢«è®¾ç½®æˆ idleï¼Œåˆ†é…ç»™è¿™å°æœºå™¨çš„ä»»åŠ¡ä¼šè¢«åˆ†å‘ç»™å…¶ä»–çš„æœºå™¨ã€‚</p>
<h2 id="master-failure">Master Failure</h2>
<p>Master å› ä¸ºåªæœ‰å°‘é‡çš„æœºå™¨ï¼Œæ‰€ä»¥å‘ç”Ÿé”™è¯¯çš„å¯èƒ½æ€§éå¸¸çš„å°ã€‚å¯ä»¥é€šè¿‡å­˜å‚¨ Master çš„çŠ¶æ€ä¸º checkpoints æ¥è¿›è¡Œé”™è¯¯æ—¶å›é€€å’Œæ¢å¤ã€‚</p>
<h1 id="mr-ç¼ºé™·">MR ç¼ºé™·</h1>
<p>MR çš„ç¼ºé™·å®é™…ä¸Šåœ¨ Google I/O ä¸Šå·²ç»è¯´æ˜äº†ï¼Œå¦‚ä¸‹:</p>
<blockquote>
<p>Today at Google I/O, we are demonstrating Google Cloud Dataflow for the first time. Cloud Dataflow is a fully managed service for creating data pipelines that ingest, transform and analyze data in both batch and streaming modes. Cloud Dataflow is a successor to MapReduce, and is based on our internal technologies like Flume and MillWheel.[2]</p>
</blockquote>
<ol>
<li>MRæ˜¯ä¸€ä¸ªåŸºäº batch mode çš„æ¡†æ¶ã€‚</li>
<li>ç”¨ MR å†™å¤æ‚çš„åˆ†æ pipeline å¤ªéº»çƒ¦ã€‚</li>
</ol>
<p>åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œä¸€æ¬¡ MR æ‰§è¡Œæ˜¯æ²¡æ³•æŠŠäº‹æƒ…åšå®Œçš„ï¼Œéœ€è¦å¾ˆå¤šä¸ª MR ä»»åŠ¡äº’ç›¸ç»„åˆï¼Œè¿™å°±æ˜¯ MR pipeline. åœ¨æ•°æ®æµå¤æ‚çš„åˆ†æä»»åŠ¡ä¸­ï¼Œè®¾è®¡å¥½çš„ pipeline è¾¾åˆ°æœ€é«˜è¿è¡Œæ•ˆç‡å¾ˆå›°éš¾ã€‚</p>
<p>MR æœ€å¤§çš„è´¡çŒ®æˆ‘è®¤ä¸ºå°±æ˜¯ scalability å’Œ fault toleranceã€‚åœ¨ MillWheel é‡Œï¼Œç»“æœå¯ä»¥éšç€æ•°æ®æµçš„è¾“å…¥å®æ—¶çš„æ˜¾ç¤ºå‡ºæ¥ï¼Œè€Œä¸æ˜¯åˆ°æ•°æ®æµç»“æŸæ—¶æ‰è¾“å‡ºä¸€ä¸ªç»“æœï¼Œè€Œä¸”è¿™æ ·ä¸­é—´ç»“æœä¸éœ€è¦ä¿å­˜ä¸‹æ¥ã€‚</p>
<h1 id="mr-lab-in-mit6824">MR Lab in MIT6.824</h1>
<p><a href="https://pdos.csail.mit.edu/6.824/labs/lab-mr.html">Check the lab-mr page here</a></p>
<p>åœ¨æœ¬å®éªŒä¸­ï¼Œæˆ‘ä»¬å°†æ„å»ºä¸€ä¸ª MapReduce ç³»ç»Ÿã€‚ æˆ‘ä»¬å°†å®ç°ä¸€ä¸ªè°ƒç”¨åº”ç”¨ç¨‹åº Map å’Œ Reduce å‡½æ•°å¹¶å¤„ç†è¯»å†™æ–‡ä»¶çš„ç¨‹åºï¼Œä»¥åŠä¸€ä¸ªå°†ä»»åŠ¡åˆ†å‘ç»™ Worker å¹¶å¤„ç†å¤±è´¥çš„ Worker çš„è¿›ç¨‹(Master)ã€‚åœ¨ MR å®éªŒä¸­ï¼Œä½¿ç”¨ Golang æ¥ç¼–ç å®ç°ã€‚</p>
<p>æˆ‘çš„å®ç°åœ¨ WSL Ubuntu20.04 ä¸Š goç‰ˆæœ¬ 1.18ã€‚</p>
<p>è¿™æ¬¡çš„è¦æ±‚è²Œä¼¼æ¯”ä»¥å‰æ›´éš¾äº†ï¼Œè¿™æ¬¡éœ€è¦ Worker ä¸»åŠ¨å‘ Master è¯·æ±‚ä»»åŠ¡ï¼Œå½“ä»»åŠ¡è¶…æ—¶åï¼Œéœ€è¦ Master æ¥é‡æ–°åˆ†é…è¿™ä¸ªä»»åŠ¡ã€‚</p>
<p>æ€»ä½“æ€è·¯å…¶å®ä¹Ÿéå¸¸çš„ç®€å•ï¼Œworker å’Œ coordinator çš„äº¤äº’éƒ½å›´ç»•ç€ RPC å±•å¼€ï¼Œæ•…å…ˆä» RPC çš„å®šä¹‰å¼€å§‹ã€‚å› ä¸ºæ·±å—äº‹ä»¶è½®è¯¢ç¼–ç¨‹æ¨¡å¼çš„&rsquo;è¼æ¯’&rsquo;ï¼Œæˆ‘æŠŠ worker å’Œ coordinator ä¹‹é—´çš„äº¤äº’è¿‡ç¨‹ä»¥äº‹ä»¶çš„å½¢å¼æ¥è¿›è¡Œå¤„ç†ã€‚é¦–å…ˆå®šä¹‰äº‹ä»¶çš„ç±»å‹ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// src/mr/rpc.go
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">TaskTp</span> = <span style="color:#66d9ef">int</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">TpRequireTask</span> = <span style="color:#66d9ef">iota</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">TpMapTaskDone</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">TpReduceTaskDone</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">TpSendMapTask</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">TpSendReduceTask</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">TpTaskAllDone</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">TpWait</span>
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><p>å†æ¥è€ƒè™‘ RPC éœ€è¦åœ¨ worker å’Œ coordinator ä¸­ä¼ é€’ä»€ä¹ˆä¿¡æ¯ï¼Ÿä¸è®ºä½•ç§ä¿¡æ¯ï¼Œé¦–å…ˆéƒ½éœ€è¦ä¸€ä¸ªæ—¶é—´æˆ³æ¥è®°å½• require å’Œ reply å¯¹ã€‚å…¶æ¬¡æ¯ä¸ª worker éƒ½éœ€è¦çŸ¥é“ä¸€å…±æœ‰å¤šå°‘ä¸ª Map å’Œ Reduce ä»»åŠ¡ã€‚æ¯ä¸ª require éœ€è¦è·Ÿä¸Šå½“å‰ worker çš„ä»»åŠ¡ç¼–å·ã€‚å½“ç„¶ï¼Œå› ä¸ºæ˜¯äº‹ä»¶é©±åŠ¨çš„è§’åº¦ç¼–å†™çš„ï¼Œæ‰€ä»¥æ¯æ¡ require å’Œ reply éƒ½éœ€è¦æœ‰ä¸€ä¸ªäº‹ä»¶ç±»å‹è®°å½•ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// src/mr/rpc.go
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">RequireMsg</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Stamp</span>   <span style="color:#66d9ef">int64</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">MsgFlag</span> <span style="color:#a6e22e">TaskTp</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">TaskID</span>  <span style="color:#66d9ef">int</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">ReplyMsg</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Stamp</span>            <span style="color:#66d9ef">int64</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">MsgFlag</span>          <span style="color:#a6e22e">TaskTp</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">TaskID</span>           <span style="color:#66d9ef">int</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">NumReduceWorkers</span> <span style="color:#66d9ef">int</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">NumMapWorkers</span>    <span style="color:#66d9ef">int</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Content</span>          <span style="color:#66d9ef">string</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><hr>
<p>å¯¹äº coordinatorï¼Œå…¶ä½œç”¨åƒæ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼Œéœ€è¦ç»´æŠ¤æ‰€æœ‰çš„ worker çš„çŠ¶æ€ï¼Œå¹¶èƒ½åšåˆ°å›é€€(Fault Tolerance)ã€‚Coordinator çš„å®šä¹‰å¦‚ä¸‹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// src/mr/coordinator.go
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Coordinator</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">nMapWorkers</span>       <span style="color:#66d9ef">int</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">nReduceWorkers</span>    <span style="color:#66d9ef">int</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">nMapWorking</span>       <span style="color:#66d9ef">int</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">nReduceWorking</span>    <span style="color:#66d9ef">int</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">MapWorkerState</span>    []<span style="color:#66d9ef">int64</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">ReduceWorkerState</span> []<span style="color:#66d9ef">int64</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">FilesContent</span>      []<span style="color:#66d9ef">string</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">MapWorkerPool</span>     <span style="color:#66d9ef">chan</span> <span style="color:#66d9ef">int</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">ReduceWorkerPool</span>  <span style="color:#66d9ef">chan</span> <span style="color:#66d9ef">int</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">IsDone</span>            <span style="color:#66d9ef">bool</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">GlobalLock</span>        <span style="color:#f92672">*</span><span style="color:#a6e22e">sync</span>.<span style="color:#a6e22e">Cond</span> <span style="color:#75715e">// to make sure the rpc visit is atomic.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><p>coordinator éœ€è¦å¤„ç† RPC çš„è¯·æ±‚ï¼Œå¯¹äºä¸åŒçš„äº‹ä»¶è¿›è¡Œååº”ã€‚å› ä¸ºéœ€è¦è¶…æ—¶å¤„ç†ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œï¼Œæ¯ä¸€ä¸ª worker éƒ½ä¼šæœ‰ä¸€ä¸ªåç¨‹æ¥è¿›è¡Œç›¸åº”çš„è®¡æ—¶å’Œ id å›æ”¶ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// src/mr/coordinator.go
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Coordinator</span>) <span style="color:#a6e22e">ProcessEvents</span>(<span style="color:#a6e22e">args</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">RequireMsg</span>, <span style="color:#a6e22e">reply</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">ReplyMsg</span>) <span style="color:#66d9ef">error</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">GlobalLock</span>.<span style="color:#a6e22e">L</span>.<span style="color:#a6e22e">Lock</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">tmpBool</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">IsDone</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">GlobalLock</span>.<span style="color:#a6e22e">L</span>.<span style="color:#a6e22e">Unlock</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">tmpBool</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">MsgFlag</span> = <span style="color:#a6e22e">TpTaskAllDone</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">Stamp</span> = <span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">Stamp</span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">switch</span> <span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">MsgFlag</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">case</span> <span style="color:#a6e22e">TpMapTaskDone</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">GlobalLock</span>.<span style="color:#a6e22e">L</span>.<span style="color:#a6e22e">Lock</span>()
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">MapWorkerState</span>[<span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">TaskID</span>] <span style="color:#f92672">==</span> <span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">Stamp</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">MapWorkerState</span>[<span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">TaskID</span>] = <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">nMapWorking</span><span style="color:#f92672">--</span>
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">GlobalLock</span>.<span style="color:#a6e22e">L</span>.<span style="color:#a6e22e">Unlock</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">case</span> <span style="color:#a6e22e">TpReduceTaskDone</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">GlobalLock</span>.<span style="color:#a6e22e">L</span>.<span style="color:#a6e22e">Lock</span>()
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">ReduceWorkerState</span>[<span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">TaskID</span>] <span style="color:#f92672">==</span> <span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">Stamp</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">ReduceWorkerState</span>[<span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">TaskID</span>] = <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">nReduceWorking</span><span style="color:#f92672">--</span>
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">nReduceWorking</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">IsDone</span> = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">GlobalLock</span>.<span style="color:#a6e22e">L</span>.<span style="color:#a6e22e">Unlock</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">case</span> <span style="color:#a6e22e">TpRequireTask</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> len(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">MapWorkerPool</span>) &gt; <span style="color:#ae81ff">0</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#75715e">// State 1. Send Map Task to worker.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>			<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">Stamp</span> = <span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">Stamp</span>
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">TaskID</span> = <span style="color:#f92672">&lt;-</span><span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">MapWorkerPool</span>
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">MsgFlag</span> = <span style="color:#a6e22e">TpSendMapTask</span>
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">NumMapWorkers</span> = <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">nMapWorkers</span>
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">NumReduceWorkers</span> = <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">nReduceWorkers</span>
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">Content</span> = <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">FilesContent</span>[<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">TaskID</span>]
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">GlobalLock</span>.<span style="color:#a6e22e">L</span>.<span style="color:#a6e22e">Lock</span>()
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">MapWorkerState</span>[<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">TaskID</span>] = <span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">Stamp</span>
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">GlobalLock</span>.<span style="color:#a6e22e">L</span>.<span style="color:#a6e22e">Unlock</span>()
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">go</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">id</span> <span style="color:#66d9ef">int</span>) {
</span></span><span style="display:flex;"><span>				<span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Sleep</span>(<span style="color:#ae81ff">10</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Second</span>)
</span></span><span style="display:flex;"><span>				<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">GlobalLock</span>.<span style="color:#a6e22e">L</span>.<span style="color:#a6e22e">Lock</span>()
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">MapWorkerState</span>[<span style="color:#a6e22e">id</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">1</span> {
</span></span><span style="display:flex;"><span>					<span style="color:#75715e">// run out of 10 secs. recycle this id to id pool.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>					<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">MapWorkerPool</span> <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">id</span>
</span></span><span style="display:flex;"><span>				}
</span></span><span style="display:flex;"><span>				<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">GlobalLock</span>.<span style="color:#a6e22e">L</span>.<span style="color:#a6e22e">Unlock</span>()
</span></span><span style="display:flex;"><span>			}(<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">TaskID</span>)
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>		} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">GlobalLock</span>.<span style="color:#a6e22e">L</span>.<span style="color:#a6e22e">Lock</span>()
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">nMapOnWorking</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">nMapWorking</span>
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">nReduceOnWorking</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">nReduceWorking</span>
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">GlobalLock</span>.<span style="color:#a6e22e">L</span>.<span style="color:#a6e22e">Unlock</span>()
</span></span><span style="display:flex;"><span>			<span style="color:#75715e">// State 2. All map worker is on working. wait.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>			<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">nMapOnWorking</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span> {
</span></span><span style="display:flex;"><span>				<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">Stamp</span> = <span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">Stamp</span>
</span></span><span style="display:flex;"><span>				<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">TaskID</span> = <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>				<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">MsgFlag</span> = <span style="color:#a6e22e">TpWait</span>
</span></span><span style="display:flex;"><span>				<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">Content</span> = <span style="color:#e6db74">&#34;Just Wait !!! Map Worker !!!&#34;</span>
</span></span><span style="display:flex;"><span>				<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">NumMapWorkers</span> = <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">nMapWorkers</span>
</span></span><span style="display:flex;"><span>				<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">NumReduceWorkers</span> = <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">nReduceWorkers</span>
</span></span><span style="display:flex;"><span>			} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>				<span style="color:#75715e">// State 3. Map is Done. Send Reduce task to works.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>				<span style="color:#66d9ef">if</span> len(<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">ReduceWorkerPool</span>) &gt; <span style="color:#ae81ff">0</span> {
</span></span><span style="display:flex;"><span>					<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">Stamp</span> = <span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">Stamp</span>
</span></span><span style="display:flex;"><span>					<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">TaskID</span> = <span style="color:#f92672">&lt;-</span><span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">ReduceWorkerPool</span>
</span></span><span style="display:flex;"><span>					<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">MsgFlag</span> = <span style="color:#a6e22e">TpSendReduceTask</span>
</span></span><span style="display:flex;"><span>					<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">Content</span> = <span style="color:#e6db74">&#34;Reduce no need to handle this&#34;</span>
</span></span><span style="display:flex;"><span>					<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">NumMapWorkers</span> = <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">nMapWorkers</span>
</span></span><span style="display:flex;"><span>					<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">NumReduceWorkers</span> = <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">nReduceWorkers</span>
</span></span><span style="display:flex;"><span>					<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">GlobalLock</span>.<span style="color:#a6e22e">L</span>.<span style="color:#a6e22e">Lock</span>()
</span></span><span style="display:flex;"><span>					<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">ReduceWorkerState</span>[<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">TaskID</span>] = <span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">Stamp</span>
</span></span><span style="display:flex;"><span>					<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">GlobalLock</span>.<span style="color:#a6e22e">L</span>.<span style="color:#a6e22e">Unlock</span>()
</span></span><span style="display:flex;"><span>					<span style="color:#66d9ef">go</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">id</span> <span style="color:#66d9ef">int</span>) {
</span></span><span style="display:flex;"><span>						<span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Sleep</span>(<span style="color:#ae81ff">10</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Second</span>)
</span></span><span style="display:flex;"><span>						<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">GlobalLock</span>.<span style="color:#a6e22e">L</span>.<span style="color:#a6e22e">Lock</span>()
</span></span><span style="display:flex;"><span>						<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">ReduceWorkerState</span>[<span style="color:#a6e22e">id</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">1</span> {
</span></span><span style="display:flex;"><span>							<span style="color:#75715e">// run out of 10 secs. resolved this id to id pool.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>							<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">ReduceWorkerPool</span> <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">id</span>
</span></span><span style="display:flex;"><span>						}
</span></span><span style="display:flex;"><span>						<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">GlobalLock</span>.<span style="color:#a6e22e">L</span>.<span style="color:#a6e22e">Unlock</span>()
</span></span><span style="display:flex;"><span>					}(<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">TaskID</span>)
</span></span><span style="display:flex;"><span>				} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>					<span style="color:#75715e">// State 4. All reduce worker is on working. wait.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>					<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">nReduceOnWorking</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span> {
</span></span><span style="display:flex;"><span>						<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">Stamp</span> = <span style="color:#a6e22e">args</span>.<span style="color:#a6e22e">Stamp</span>
</span></span><span style="display:flex;"><span>						<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">TaskID</span> = <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>						<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">MsgFlag</span> = <span style="color:#a6e22e">TpWait</span>
</span></span><span style="display:flex;"><span>						<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">Content</span> = <span style="color:#e6db74">&#34;Just Wait !!! Reduce Worker !!!&#34;</span>
</span></span><span style="display:flex;"><span>						<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">NumMapWorkers</span> = <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">nMapWorkers</span>
</span></span><span style="display:flex;"><span>						<span style="color:#a6e22e">reply</span>.<span style="color:#a6e22e">NumReduceWorkers</span> = <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">nReduceWorkers</span>
</span></span><span style="display:flex;"><span>					}
</span></span><span style="display:flex;"><span>				}
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">default</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>åŒæ ·çš„ï¼Œåœ¨ worker ä¸­çš„æµç¨‹ä¹Ÿæ˜¯ä¸æ–­çš„å¾ªç¯äº§ç”Ÿäº‹ä»¶ï¼Œå¤„ç†äº‹ä»¶</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// src/mr/worker.go
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">Worker</span>(<span style="color:#a6e22e">mapf</span> <span style="color:#66d9ef">func</span>(<span style="color:#66d9ef">string</span>, <span style="color:#66d9ef">string</span>) []<span style="color:#a6e22e">KeyValue</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">reducef</span> <span style="color:#66d9ef">func</span>(<span style="color:#66d9ef">string</span>, []<span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">string</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#66d9ef">true</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">ThisStamp</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>().<span style="color:#a6e22e">Unix</span>()
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">Req</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">RequireMsg</span>{}
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">Req</span>.<span style="color:#a6e22e">Stamp</span> = <span style="color:#a6e22e">ThisStamp</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">Req</span>.<span style="color:#a6e22e">MsgFlag</span> = <span style="color:#a6e22e">TpRequireTask</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">Req</span>.<span style="color:#a6e22e">TaskID</span> = <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">Rep</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ReplyMsg</span>{}
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">ok</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">call</span>(<span style="color:#e6db74">&#34;Coordinator.ProcessEvents&#34;</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">Req</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">Rep</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">ok</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">Rep</span>.<span style="color:#a6e22e">Stamp</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">Req</span>.<span style="color:#a6e22e">Stamp</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">switch</span> <span style="color:#a6e22e">Rep</span>.<span style="color:#a6e22e">MsgFlag</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">case</span> <span style="color:#a6e22e">TpSendMapTask</span>:
</span></span><span style="display:flex;"><span>				<span style="color:#a6e22e">doMap</span>(<span style="color:#a6e22e">mapf</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">Rep</span>)
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">case</span> <span style="color:#a6e22e">TpSendReduceTask</span>:
</span></span><span style="display:flex;"><span>				<span style="color:#a6e22e">doReduce</span>(<span style="color:#a6e22e">reducef</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">Rep</span>)
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">case</span> <span style="color:#a6e22e">TpWait</span>:
</span></span><span style="display:flex;"><span>				<span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Sleep</span>(<span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Second</span>)
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">case</span> <span style="color:#a6e22e">TpTaskAllDone</span>:
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">default</span>:
</span></span><span style="display:flex;"><span>				<span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><code>doMap(mapf, &amp;Rep)</code> å’Œ <code>doReduce(reducef, &amp;Rep)</code> å°±æ˜¯éå¸¸ç®€å•çš„é€»è¾‘ç¼–å†™äº†ã€‚Mapéœ€è¦æŠŠæ–‡ä»¶åˆ†æ‹†åˆ°<code>N=numReduce</code>å—ä¸­ï¼Œæ€»å…±äº§ç”Ÿ<code>N * M(reduce num, map num)</code>å—æ–‡ä»¶ã€‚Reduce workerä»è‡ªå·±å¯¹åº”çš„ç¼–å·ä¸­å–å‡º<code>M</code>å—è¿›è¡Œæ’åºå’Œåˆå¹¶ã€‚</p>
<hr>
<p>ç»“æœé¡ºåˆ©é€šè¿‡ï¼Œæ²¡æœ‰è¿‡å¤šçš„å»¶è¿Ÿ(å› ä¸º10sçš„åˆ¤æ–­)äº§ç”Ÿã€‚</p>
<div align="center"> 
<img src="/keep-moving-forward/imgs/test-mr-pass.png" width = "40%"/>
<br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">Fig 2. test mr</div>
</div>
<h1 id="reference">Reference</h1>
<p>[1] &ldquo;MapReduce: Simplified Data Processing on Large Clusters&rdquo; googleusercontent.com.</p>
<p>[2] <a href="https://cloudplatform.googleblog.com/2014/06/reimagining-developer-productivity-and-data-analytics-in-the-cloud-news-from-google-io.html">Google cloud blog about MapReduce&rsquo;s successor</a></p>

		</div>
	</article>
</main>

<div class="authorbox clearfix">
	<figure class="authorbox__avatar">
		<img alt="chenghua.wang avatar" src="/keep-moving-forward/img/Cornell_box.png" class="avatar" height="90" width="90">
	</figure>
	<div class="authorbox__header">
		<span class="authorbox__name">About chenghua.wang</span>
	</div>
	<div class="authorbox__description">
		Learning and developing Machine learning infrastructure now. Did some works in Computer Vision and Graphics.
	</div>
</div>

<nav class="pager flex">
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/keep-moving-forward/papers/gfs/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">Google File System(GFS)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 chenghua.wang.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/keep-moving-forward/js/menu.js"></script>




<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      processEscapes: true
    },
    "HTML-CSS": { fonts: ["TeX"] }
  });
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async>
</script>
</body>
</html>